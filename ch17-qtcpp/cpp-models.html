<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Models in C++ | Qt 6 书籍</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="一本关于 QML 的书">
    
    <link rel="preload" href="/qt6book/assets/css/0.styles.fdf3cb50.css" as="style"><link rel="preload" href="/qt6book/assets/js/app.49f675f8.js" as="script"><link rel="preload" href="/qt6book/assets/js/2.ea318f3c.js" as="script"><link rel="preload" href="/qt6book/assets/js/75.fa040cbb.js" as="script"><link rel="prefetch" href="/qt6book/assets/js/10.70a34b30.js"><link rel="prefetch" href="/qt6book/assets/js/100.cff7a886.js"><link rel="prefetch" href="/qt6book/assets/js/101.503e20ce.js"><link rel="prefetch" href="/qt6book/assets/js/102.395792fa.js"><link rel="prefetch" href="/qt6book/assets/js/103.071d8b78.js"><link rel="prefetch" href="/qt6book/assets/js/104.f33ee0ed.js"><link rel="prefetch" href="/qt6book/assets/js/105.bb2168fe.js"><link rel="prefetch" href="/qt6book/assets/js/106.0e951818.js"><link rel="prefetch" href="/qt6book/assets/js/107.a51bd278.js"><link rel="prefetch" href="/qt6book/assets/js/108.eefe809c.js"><link rel="prefetch" href="/qt6book/assets/js/109.744ac99b.js"><link rel="prefetch" href="/qt6book/assets/js/11.82909cde.js"><link rel="prefetch" href="/qt6book/assets/js/110.11ad155f.js"><link rel="prefetch" href="/qt6book/assets/js/111.56537df6.js"><link rel="prefetch" href="/qt6book/assets/js/112.628464f9.js"><link rel="prefetch" href="/qt6book/assets/js/113.893d1439.js"><link rel="prefetch" href="/qt6book/assets/js/114.c00f3590.js"><link rel="prefetch" href="/qt6book/assets/js/115.319d8826.js"><link rel="prefetch" href="/qt6book/assets/js/116.a36dfadb.js"><link rel="prefetch" href="/qt6book/assets/js/117.24dc552e.js"><link rel="prefetch" href="/qt6book/assets/js/118.8bc8de4e.js"><link rel="prefetch" href="/qt6book/assets/js/119.bb5fbbd6.js"><link rel="prefetch" href="/qt6book/assets/js/12.7c20b914.js"><link rel="prefetch" href="/qt6book/assets/js/120.63c90b9f.js"><link rel="prefetch" href="/qt6book/assets/js/121.64979c23.js"><link rel="prefetch" href="/qt6book/assets/js/122.410ce3c2.js"><link rel="prefetch" href="/qt6book/assets/js/123.3ceaa95e.js"><link rel="prefetch" href="/qt6book/assets/js/124.78e05194.js"><link rel="prefetch" href="/qt6book/assets/js/125.6d9b2679.js"><link rel="prefetch" href="/qt6book/assets/js/126.77bf1e01.js"><link rel="prefetch" href="/qt6book/assets/js/127.d3b82f75.js"><link rel="prefetch" href="/qt6book/assets/js/128.9d705e68.js"><link rel="prefetch" href="/qt6book/assets/js/129.37f588a9.js"><link rel="prefetch" href="/qt6book/assets/js/13.44fdf993.js"><link rel="prefetch" href="/qt6book/assets/js/130.93765866.js"><link rel="prefetch" href="/qt6book/assets/js/131.12d0d18e.js"><link rel="prefetch" href="/qt6book/assets/js/132.f488195c.js"><link rel="prefetch" href="/qt6book/assets/js/133.6ef1565d.js"><link rel="prefetch" href="/qt6book/assets/js/134.f3e8c361.js"><link rel="prefetch" href="/qt6book/assets/js/135.b397c9b2.js"><link rel="prefetch" href="/qt6book/assets/js/136.7da1e551.js"><link rel="prefetch" href="/qt6book/assets/js/137.357076e2.js"><link rel="prefetch" href="/qt6book/assets/js/138.42b20678.js"><link rel="prefetch" href="/qt6book/assets/js/139.21e63093.js"><link rel="prefetch" href="/qt6book/assets/js/14.b10bffa3.js"><link rel="prefetch" href="/qt6book/assets/js/140.dfcc4732.js"><link rel="prefetch" href="/qt6book/assets/js/141.6317fc32.js"><link rel="prefetch" href="/qt6book/assets/js/142.288153ef.js"><link rel="prefetch" href="/qt6book/assets/js/143.4eff9ad0.js"><link rel="prefetch" href="/qt6book/assets/js/144.39149a0f.js"><link rel="prefetch" href="/qt6book/assets/js/145.ce392d81.js"><link rel="prefetch" href="/qt6book/assets/js/15.f918e179.js"><link rel="prefetch" href="/qt6book/assets/js/16.5d3c40fb.js"><link rel="prefetch" href="/qt6book/assets/js/17.2614a8fe.js"><link rel="prefetch" href="/qt6book/assets/js/18.b8e87e84.js"><link rel="prefetch" href="/qt6book/assets/js/19.cb8358b7.js"><link rel="prefetch" href="/qt6book/assets/js/20.a509c2f7.js"><link rel="prefetch" href="/qt6book/assets/js/21.fac41553.js"><link rel="prefetch" href="/qt6book/assets/js/22.b8bb6616.js"><link rel="prefetch" href="/qt6book/assets/js/23.ec36efe8.js"><link rel="prefetch" href="/qt6book/assets/js/24.a38239b6.js"><link rel="prefetch" href="/qt6book/assets/js/25.6ec5c6a5.js"><link rel="prefetch" href="/qt6book/assets/js/26.3f43459b.js"><link rel="prefetch" href="/qt6book/assets/js/27.b4de3c2a.js"><link rel="prefetch" href="/qt6book/assets/js/28.3d1a74fb.js"><link rel="prefetch" href="/qt6book/assets/js/29.0e1f197c.js"><link rel="prefetch" href="/qt6book/assets/js/3.112743a2.js"><link rel="prefetch" href="/qt6book/assets/js/30.69e1ba2b.js"><link rel="prefetch" href="/qt6book/assets/js/31.180e6ae8.js"><link rel="prefetch" href="/qt6book/assets/js/32.95f52d7a.js"><link rel="prefetch" href="/qt6book/assets/js/33.19531560.js"><link rel="prefetch" href="/qt6book/assets/js/34.1b2d9f18.js"><link rel="prefetch" href="/qt6book/assets/js/35.10c030c6.js"><link rel="prefetch" href="/qt6book/assets/js/36.51dde79c.js"><link rel="prefetch" href="/qt6book/assets/js/37.f955e155.js"><link rel="prefetch" href="/qt6book/assets/js/38.c5b68607.js"><link rel="prefetch" href="/qt6book/assets/js/39.28538ce3.js"><link rel="prefetch" href="/qt6book/assets/js/4.6ee77bf2.js"><link rel="prefetch" href="/qt6book/assets/js/40.c0ad21c1.js"><link rel="prefetch" href="/qt6book/assets/js/41.105e2872.js"><link rel="prefetch" href="/qt6book/assets/js/42.55911116.js"><link rel="prefetch" href="/qt6book/assets/js/43.8e441a9e.js"><link rel="prefetch" href="/qt6book/assets/js/44.35b2ff29.js"><link rel="prefetch" href="/qt6book/assets/js/45.7d1d010c.js"><link rel="prefetch" href="/qt6book/assets/js/46.7585557d.js"><link rel="prefetch" href="/qt6book/assets/js/47.450265aa.js"><link rel="prefetch" href="/qt6book/assets/js/48.f236e58d.js"><link rel="prefetch" href="/qt6book/assets/js/49.85eb3fbd.js"><link rel="prefetch" href="/qt6book/assets/js/5.c6d72f08.js"><link rel="prefetch" href="/qt6book/assets/js/50.0196025d.js"><link rel="prefetch" href="/qt6book/assets/js/51.1a5823e9.js"><link rel="prefetch" href="/qt6book/assets/js/52.83e09db4.js"><link rel="prefetch" href="/qt6book/assets/js/53.dedb04ac.js"><link rel="prefetch" href="/qt6book/assets/js/54.80561be2.js"><link rel="prefetch" href="/qt6book/assets/js/55.d2a21221.js"><link rel="prefetch" href="/qt6book/assets/js/56.564ff842.js"><link rel="prefetch" href="/qt6book/assets/js/57.757d907a.js"><link rel="prefetch" href="/qt6book/assets/js/58.50225fe8.js"><link rel="prefetch" href="/qt6book/assets/js/59.9e233383.js"><link rel="prefetch" href="/qt6book/assets/js/6.381344fb.js"><link rel="prefetch" href="/qt6book/assets/js/60.04d29815.js"><link rel="prefetch" href="/qt6book/assets/js/61.0c74ecb4.js"><link rel="prefetch" href="/qt6book/assets/js/62.d5c85dcf.js"><link rel="prefetch" href="/qt6book/assets/js/63.8775d8a6.js"><link rel="prefetch" href="/qt6book/assets/js/64.d6548a41.js"><link rel="prefetch" href="/qt6book/assets/js/65.9ab78926.js"><link rel="prefetch" href="/qt6book/assets/js/66.cd7855b2.js"><link rel="prefetch" href="/qt6book/assets/js/67.1ff5900b.js"><link rel="prefetch" href="/qt6book/assets/js/68.74f0245e.js"><link rel="prefetch" href="/qt6book/assets/js/69.1b2e800d.js"><link rel="prefetch" href="/qt6book/assets/js/7.53dffc97.js"><link rel="prefetch" href="/qt6book/assets/js/70.19fafa64.js"><link rel="prefetch" href="/qt6book/assets/js/71.aca6355b.js"><link rel="prefetch" href="/qt6book/assets/js/72.1a3808cd.js"><link rel="prefetch" href="/qt6book/assets/js/73.de73d4a5.js"><link rel="prefetch" href="/qt6book/assets/js/74.4f6fdc1a.js"><link rel="prefetch" href="/qt6book/assets/js/76.c943dcfb.js"><link rel="prefetch" href="/qt6book/assets/js/77.5e5240a0.js"><link rel="prefetch" href="/qt6book/assets/js/78.4352cfdb.js"><link rel="prefetch" href="/qt6book/assets/js/79.64132667.js"><link rel="prefetch" href="/qt6book/assets/js/8.a29b933c.js"><link rel="prefetch" href="/qt6book/assets/js/80.99cf0f52.js"><link rel="prefetch" href="/qt6book/assets/js/81.8dc9b0d5.js"><link rel="prefetch" href="/qt6book/assets/js/82.e60a2b4d.js"><link rel="prefetch" href="/qt6book/assets/js/83.ff48a41f.js"><link rel="prefetch" href="/qt6book/assets/js/84.72db517a.js"><link rel="prefetch" href="/qt6book/assets/js/85.876eef38.js"><link rel="prefetch" href="/qt6book/assets/js/86.5ed4ad32.js"><link rel="prefetch" href="/qt6book/assets/js/87.8df5143a.js"><link rel="prefetch" href="/qt6book/assets/js/88.94bf0081.js"><link rel="prefetch" href="/qt6book/assets/js/89.0272804b.js"><link rel="prefetch" href="/qt6book/assets/js/9.7436ab3c.js"><link rel="prefetch" href="/qt6book/assets/js/90.871c44c7.js"><link rel="prefetch" href="/qt6book/assets/js/91.c38e4ee7.js"><link rel="prefetch" href="/qt6book/assets/js/92.d79de636.js"><link rel="prefetch" href="/qt6book/assets/js/93.81493d9a.js"><link rel="prefetch" href="/qt6book/assets/js/94.4eef95b9.js"><link rel="prefetch" href="/qt6book/assets/js/95.3804e65e.js"><link rel="prefetch" href="/qt6book/assets/js/96.360acf76.js"><link rel="prefetch" href="/qt6book/assets/js/97.6a742d1c.js"><link rel="prefetch" href="/qt6book/assets/js/98.7e121e3a.js"><link rel="prefetch" href="/qt6book/assets/js/99.86b18043.js">
    <link rel="stylesheet" href="/qt6book/assets/css/0.styles.fdf3cb50.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/qt6book/" class="home-link router-link-active"><!----> <span class="site-name">Qt 6 书籍</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/dogifyc/qt6book" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/dogifyc/qt6book" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/qt6book/preface/preface" class="sidebar-heading clickable"><span>前言</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/preface/preface.html" class="sidebar-link">欢迎！</a></li><li><a href="/qt6book/preface/acknowledgements.html" class="sidebar-link">鸣谢</a></li><li><a href="/qt6book/preface/authors.html" class="sidebar-link">作者</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch01-meetqt/meet-qt" class="sidebar-heading clickable"><span>遇见 Qt</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch01-meetqt/meet-qt.html" class="sidebar-link">Qt 和 Qt Quick</a></li><li><a href="/qt6book/ch01-meetqt/blocks.html" class="sidebar-link">Qt 构成</a></li><li><a href="/qt6book/ch01-meetqt/intro.html" class="sidebar-link">Qt 6 简介</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch02-start/quick-start" class="sidebar-heading clickable"><span>起步</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch02-start/quick-start.html" class="sidebar-link">快速开始</a></li><li><a href="/qt6book/ch02-start/install.html" class="sidebar-link">安装 Qt 6 SDK</a></li><li><a href="/qt6book/ch02-start/hello-world.html" class="sidebar-link">Hello World</a></li><li><a href="/qt6book/ch02-start/app-types.html" class="sidebar-link">应用类型</a></li><li><a href="/qt6book/ch02-start/summary.html" class="sidebar-link">摘要</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch03-qtcreator/qt-creator" class="sidebar-heading clickable"><span>Qt Creator IDE</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch03-qtcreator/qt-creator.html" class="sidebar-link">Qt Creator IDE</a></li><li><a href="/qt6book/ch03-qtcreator/user-interface.html" class="sidebar-link">用户界面</a></li><li><a href="/qt6book/ch03-qtcreator/kit-registry.html" class="sidebar-link">注册 Qt 套件</a></li><li><a href="/qt6book/ch03-qtcreator/projects.html" class="sidebar-link">项目管理</a></li><li><a href="/qt6book/ch03-qtcreator/editor.html" class="sidebar-link">使用编辑器</a></li><li><a href="/qt6book/ch03-qtcreator/locator.html" class="sidebar-link">定位器</a></li><li><a href="/qt6book/ch03-qtcreator/debugging.html" class="sidebar-link">调试</a></li><li><a href="/qt6book/ch03-qtcreator/shortcuts.html" class="sidebar-link">快捷键</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch04-qmlstart/quick-start" class="sidebar-heading clickable"><span>快速开始</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch04-qmlstart/quick-start.html" class="sidebar-link">快速开始</a></li><li><a href="/qt6book/ch04-qmlstart/qml-syntax.html" class="sidebar-link">QML 语法</a></li><li><a href="/qt6book/ch04-qmlstart/core-elements.html" class="sidebar-link">核心元素</a></li><li><a href="/qt6book/ch04-qmlstart/components.html" class="sidebar-link">组件</a></li><li><a href="/qt6book/ch04-qmlstart/transformations.html" class="sidebar-link">简单变化</a></li><li><a href="/qt6book/ch04-qmlstart/positioning.html" class="sidebar-link">定位元素</a></li><li><a href="/qt6book/ch04-qmlstart/layout.html" class="sidebar-link">布局元素</a></li><li><a href="/qt6book/ch04-qmlstart/input.html" class="sidebar-link">输入元素</a></li><li><a href="/qt6book/ch04-qmlstart/advanced.html" class="sidebar-link">进阶技巧</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch05-fluid/fluid-elements" class="sidebar-heading clickable"><span>流式元素</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch05-fluid/fluid-elements.html" class="sidebar-link">流式元素</a></li><li><a href="/qt6book/ch05-fluid/animations.html" class="sidebar-link">动画</a></li><li><a href="/qt6book/ch05-fluid/states-transitions.html" class="sidebar-link">状态和过渡</a></li><li><a href="/qt6book/ch05-fluid/advanced.html" class="sidebar-link">进阶技巧</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch06-controls/controls2" class="sidebar-heading clickable"><span>QtQuick Controls</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch06-controls/controls2.html" class="sidebar-link">UI Controls</a></li><li><a href="/qt6book/ch06-controls/introduction.html" class="sidebar-link">Controls 简介</a></li><li><a href="/qt6book/ch06-controls/image-viewer.html" class="sidebar-link">Image 查看器</a></li><li><a href="/qt6book/ch06-controls/common-patterns.html" class="sidebar-link">Common Patterns</a></li><li><a href="/qt6book/ch06-controls/imagine-style.html" class="sidebar-link">The Imagine Style</a></li><li><a href="/qt6book/ch06-controls/summary.html" class="sidebar-link">Summary</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch07-modelview/model-view" class="sidebar-heading clickable"><span>Model View</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch07-modelview/model-view.html" class="sidebar-link">Model-View-Delegate</a></li><li><a href="/qt6book/ch07-modelview/concept.html" class="sidebar-link">Concept</a></li><li><a href="/qt6book/ch07-modelview/basic-models.html" class="sidebar-link">Basic Models</a></li><li><a href="/qt6book/ch07-modelview/dynamic-views.html" class="sidebar-link">Dynamic Views</a></li><li><a href="/qt6book/ch07-modelview/delegate.html" class="sidebar-link">Delegate</a></li><li><a href="/qt6book/ch07-modelview/advanced.html" class="sidebar-link">Advanced Techniques</a></li><li><a href="/qt6book/ch07-modelview/summary.html" class="sidebar-link">Summary</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch08-canvas/canvas-element" class="sidebar-heading clickable"><span>Canvas</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch08-canvas/canvas-element.html" class="sidebar-link">Canvas Element</a></li><li><a href="/qt6book/ch08-canvas/convenience-api.html" class="sidebar-link">Convenience API</a></li><li><a href="/qt6book/ch08-canvas/gradients.html" class="sidebar-link">Gradients</a></li><li><a href="/qt6book/ch08-canvas/shadows.html" class="sidebar-link">Shadows</a></li><li><a href="/qt6book/ch08-canvas/images.html" class="sidebar-link">Images</a></li><li><a href="/qt6book/ch08-canvas/transformation.html" class="sidebar-link">Transformation</a></li><li><a href="/qt6book/ch08-canvas/composition-modes.html" class="sidebar-link">Composition Modes</a></li><li><a href="/qt6book/ch08-canvas/pixel-buffer.html" class="sidebar-link">Pixel Buffers</a></li><li><a href="/qt6book/ch08-canvas/canvas-paint.html" class="sidebar-link">Canvas Paint</a></li><li><a href="/qt6book/ch08-canvas/port-from-html.html" class="sidebar-link">Porting from HTML5 Canvas</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch09-shapes/shapes" class="sidebar-heading clickable"><span>Shapes</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch09-shapes/shapes.html" class="sidebar-link">Shapes</a></li><li><a href="/qt6book/ch09-shapes/basics.html" class="sidebar-link">A Basic Shape</a></li><li><a href="/qt6book/ch09-shapes/paths.html" class="sidebar-link">Building Paths</a></li><li><a href="/qt6book/ch09-shapes/gradients.html" class="sidebar-link">Filling Shapes</a></li><li><a href="/qt6book/ch09-shapes/animations.html" class="sidebar-link">Animating Shapes</a></li><li><a href="/qt6book/ch09-shapes/summary.html" class="sidebar-link">Summary</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch10-effects/effects" class="sidebar-heading clickable"><span>Effects</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch10-effects/effects.html" class="sidebar-link">Effects in QML</a></li><li><a href="/qt6book/ch10-effects/particles.html" class="sidebar-link">Particle Concept</a></li><li><a href="/qt6book/ch10-effects/simple-simulation.html" class="sidebar-link">Simple Simulation</a></li><li><a href="/qt6book/ch10-effects/particle-parameters.html" class="sidebar-link">Particle Parameters</a></li><li><a href="/qt6book/ch10-effects/directed-particles.html" class="sidebar-link">Directed Particles</a></li><li><a href="/qt6book/ch10-effects/affecting-particles.html" class="sidebar-link">Affecting Particles</a></li><li><a href="/qt6book/ch10-effects/particle-groups.html" class="sidebar-link">Particle Groups</a></li><li><a href="/qt6book/ch10-effects/particle-painters.html" class="sidebar-link">Particle Painters</a></li><li><a href="/qt6book/ch10-effects/opengl-shaders.html" class="sidebar-link">Graphics Shaders</a></li><li><a href="/qt6book/ch10-effects/shader-elements.html" class="sidebar-link">Shader Elements</a></li><li><a href="/qt6book/ch10-effects/fragment-shaders.html" class="sidebar-link">Fragment Shaders</a></li><li><a href="/qt6book/ch10-effects/wave-effect.html" class="sidebar-link">Wave Effect</a></li><li><a href="/qt6book/ch10-effects/vertex-shader.html" class="sidebar-link">Vertex Shader</a></li><li><a href="/qt6book/ch10-effects/curtain-effect.html" class="sidebar-link">Curtain Effect</a></li><li><a href="/qt6book/ch10-effects/summary.html" class="sidebar-link">Summary</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch11-multimedia/multimedia" class="sidebar-heading clickable"><span>Multimedia</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch11-multimedia/multimedia.html" class="sidebar-link">Multimedia</a></li><li><a href="/qt6book/ch11-multimedia/playing-media.html" class="sidebar-link">Playing Media</a></li><li><a href="/qt6book/ch11-multimedia/sound-effects.html" class="sidebar-link">Sound Effects</a></li><li><a href="/qt6book/ch11-multimedia/video-streams.html" class="sidebar-link">Video Streams</a></li><li><a href="/qt6book/ch11-multimedia/capturing-images.html" class="sidebar-link">Capturing Images</a></li><li><a href="/qt6book/ch11-multimedia/summary.html" class="sidebar-link">Summary</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch12-qtquick3d/intro" class="sidebar-heading clickable"><span>Qt Quick 3D</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch12-qtquick3d/intro.html" class="sidebar-link">Qt Quick 3D</a></li><li><a href="/qt6book/ch12-qtquick3d/basics.html" class="sidebar-link">The Basics</a></li><li><a href="/qt6book/ch12-qtquick3d/assets.html" class="sidebar-link">Working with Assets</a></li><li><a href="/qt6book/ch12-qtquick3d/materials-and-light.html" class="sidebar-link">Materials and Light</a></li><li><a href="/qt6book/ch12-qtquick3d/animations.html" class="sidebar-link">Animations</a></li><li><a href="/qt6book/ch12-qtquick3d/mixing-2d-and-3d.html" class="sidebar-link">Mixing 2D and 3D Contents</a></li><li><a href="/qt6book/ch12-qtquick3d/summary.html" class="sidebar-link">Summary</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch13-networking/networking" class="sidebar-heading clickable"><span>Networking</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch13-networking/networking.html" class="sidebar-link">Networking</a></li><li><a href="/qt6book/ch13-networking/serve-qml.html" class="sidebar-link">Serving UI via HTTP</a></li><li><a href="/qt6book/ch13-networking/templates.html" class="sidebar-link">Templates</a></li><li><a href="/qt6book/ch13-networking/http-requests.html" class="sidebar-link">HTTP Requests</a></li><li><a href="/qt6book/ch13-networking/local-files.html" class="sidebar-link">Local files</a></li><li><a href="/qt6book/ch13-networking/rest-api.html" class="sidebar-link">REST API</a></li><li><a href="/qt6book/ch13-networking/authentication.html" class="sidebar-link">Authentication using OAuth</a></li><li><a href="/qt6book/ch13-networking/web-sockets.html" class="sidebar-link">Web Sockets</a></li><li><a href="/qt6book/ch13-networking/summary.html" class="sidebar-link">Summary</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch14-storage/storage" class="sidebar-heading clickable"><span>Storage</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch14-storage/storage.html" class="sidebar-link">Storage</a></li><li><a href="/qt6book/ch14-storage/settings.html" class="sidebar-link">Settings</a></li><li><a href="/qt6book/ch14-storage/local-storage.html" class="sidebar-link">Local Storage - SQL</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch15-dynamicqml/dynamic-qml" class="sidebar-heading clickable"><span>Dynamic QML</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch15-dynamicqml/dynamic-qml.html" class="sidebar-link">Dynamic QML</a></li><li><a href="/qt6book/ch15-dynamicqml/loading-components.html" class="sidebar-link">Loading Components Dynamically</a></li><li><a href="/qt6book/ch15-dynamicqml/dynamic-objects.html" class="sidebar-link">Creating and Destroying Objects</a></li><li><a href="/qt6book/ch15-dynamicqml/tracking-objects.html" class="sidebar-link">Tracking Dynamic Objects</a></li><li><a href="/qt6book/ch15-dynamicqml/summary.html" class="sidebar-link">Summary</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch16-javascript/javascript" class="sidebar-heading clickable"><span>Javascript</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch16-javascript/javascript.html" class="sidebar-link">JavaScript</a></li><li><a href="/qt6book/ch16-javascript/html-qml.html" class="sidebar-link">Browser/HTML vs Qt Quick/QML</a></li><li><a href="/qt6book/ch16-javascript/js-language.html" class="sidebar-link">JS Language</a></li><li><a href="/qt6book/ch16-javascript/js-objects.html" class="sidebar-link">JS Objects</a></li><li><a href="/qt6book/ch16-javascript/js-console.html" class="sidebar-link">Creating a JS Console</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch17-qtcpp/qtcpp" class="sidebar-heading clickable open"><span>Qt C++</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch17-qtcpp/qtcpp.html" class="sidebar-link">Qt and C++</a></li><li><a href="/qt6book/ch17-qtcpp/boilerplate.html" class="sidebar-link">A Boilerplate Application</a></li><li><a href="/qt6book/ch17-qtcpp/qobject.html" class="sidebar-link">The QObject</a></li><li><a href="/qt6book/ch17-qtcpp/build-system.html" class="sidebar-link">Build Systems</a></li><li><a href="/qt6book/ch17-qtcpp/common-classes.html" class="sidebar-link">Common Qt Classes</a></li><li><a href="/qt6book/ch17-qtcpp/cpp-models.html" aria-current="page" class="active sidebar-link">Models in C++</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/qt6book/ch17-qtcpp/cpp-models.html#a-simple-model" class="sidebar-link">A simple model</a></li><li class="sidebar-sub-header"><a href="/qt6book/ch17-qtcpp/cpp-models.html#more-complex-data" class="sidebar-link">More Complex Data</a></li><li class="sidebar-sub-header"><a href="/qt6book/ch17-qtcpp/cpp-models.html#dynamic-data" class="sidebar-link">Dynamic Data</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch18-extensions/extending-qml" class="sidebar-heading clickable"><span>Extending QML</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch18-extensions/extending-qml.html" class="sidebar-link">Extending QML with C++</a></li><li><a href="/qt6book/ch18-extensions/qml-runtime.html" class="sidebar-link">Understanding the QML Run-time</a></li><li><a href="/qt6book/ch18-extensions/plugin-content.html" class="sidebar-link">Plugin Content</a></li><li><a href="/qt6book/ch18-extensions/create-plugin.html" class="sidebar-link">Creating the plugin</a></li><li><a href="/qt6book/ch18-extensions/fileio-demo.html" class="sidebar-link">FileIO Implementation</a></li><li><a href="/qt6book/ch18-extensions/using-fileio.html" class="sidebar-link">Using FileIO</a></li><li><a href="/qt6book/ch18-extensions/summary.html" class="sidebar-link">Summary</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch19-python/qt-python" class="sidebar-heading clickable"><span>Qt for Python</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch19-python/qt-python.html" class="sidebar-link">Qt for Python</a></li><li><a href="/qt6book/ch19-python/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/qt6book/ch19-python/installing.html" class="sidebar-link">Installing</a></li><li><a href="/qt6book/ch19-python/build-app.html" class="sidebar-link">Building an Application</a></li><li><a href="/qt6book/ch19-python/limitations.html" class="sidebar-link">Limitations</a></li><li><a href="/qt6book/ch19-python/summary.html" class="sidebar-link">Summary</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch20-qtformcu/qtformcu" class="sidebar-heading clickable"><span>Qt for MCUs</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch20-qtformcu/qtformcu.html" class="sidebar-link">Qt for MCUs</a></li><li><a href="/qt6book/ch20-qtformcu/setup.html" class="sidebar-link">Setup</a></li><li><a href="/qt6book/ch20-qtformcu/helloworld.html" class="sidebar-link">Hello World - for MCUs</a></li><li><a href="/qt6book/ch20-qtformcu/cpp.html" class="sidebar-link">Integrating with C++</a></li><li><a href="/qt6book/ch20-qtformcu/models.html" class="sidebar-link">Working with Models</a></li><li><a href="/qt6book/ch20-qtformcu/summary.html" class="sidebar-link">Summary</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="models-in-c"><a href="#models-in-c" class="header-anchor">#</a> Models in C++</h1> <p>One of the most common ways to integrate C++ and QML is through <em>models</em>. A <em>model</em> provides data to a <em>view</em> such as  <code>ListViews</code>, <code>GridView</code>, <code>PathViews</code>, and other views which take a model and create an instance of a delegate for each entry in the model. The view is smart enough to only create these instances which are visible or in the cache range. This makes it possible to have large models with tens of thousands of entries but still have a very slick user interface. The delegate acts like a template to be rendered with the model entries data. So in summary: a view renders entries from the model using a delegate as a template. The model is a data provider for views.</p> <p>When you do not want to use C++ you can also define models in pure QML. You have several ways to provide a model for the view. For handling of data coming from C++ or a large amount of data, the C++ model is more suitable than this pure QML approach. But often you only need a few entries then these QML models are well suited.</p> <div class="language-qml extra-class"><pre class="language-qml"><code><span class="token class-name">ListView</span> <span class="token punctuation">{</span>
    <span class="token comment">// using a integer as model</span>
    <span class="token property">model</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">5</span></span>
    <span class="token property">delegate</span><span class="token punctuation">:</span> <span class="token class-name">Text</span> <span class="token punctuation">{</span> <span class="token property">text</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token string">'index: '</span> <span class="token operator">+</span> index </span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token class-name">ListView</span> <span class="token punctuation">{</span>
    <span class="token comment">// using a JS array as model</span>
    <span class="token property">model</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>'A'<span class="token punctuation">,</span> 'B'<span class="token punctuation">,</span> 'C'<span class="token punctuation">,</span> 'D'<span class="token punctuation">,</span> 'E'<span class="token punctuation">]</span>
    <span class="token property">delegate</span><span class="token punctuation">:</span> <span class="token class-name">Text</span> <span class="token punctuation">{</span> 'Char<span class="token punctuation">[</span>'+ index +'<span class="token punctuation">]</span><span class="token punctuation">:</span> ' + modelData <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token class-name">ListView</span> <span class="token punctuation">{</span>
    <span class="token comment">// using a dynamic QML ListModel as model</span>
    <span class="token property">model</span><span class="token punctuation">:</span> <span class="token class-name">ListModel</span> <span class="token punctuation">{</span>
        <span class="token class-name">ListElement</span> <span class="token punctuation">{</span> <span class="token property">char</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token string">'A'</span> </span><span class="token punctuation">}</span>
        <span class="token class-name">ListElement</span> <span class="token punctuation">{</span> <span class="token property">char</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token string">'B'</span> </span><span class="token punctuation">}</span>
        <span class="token class-name">ListElement</span> <span class="token punctuation">{</span> <span class="token property">char</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token string">'C'</span> </span><span class="token punctuation">}</span>
        <span class="token class-name">ListElement</span> <span class="token punctuation">{</span> <span class="token property">char</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token string">'D'</span> </span><span class="token punctuation">}</span>
        <span class="token class-name">ListElement</span> <span class="token punctuation">{</span> <span class="token property">char</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token string">'E'</span> </span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token property">delegate</span><span class="token punctuation">:</span> <span class="token class-name">Text</span> <span class="token punctuation">{</span> 'Char<span class="token punctuation">[</span>'+ index +'<span class="token punctuation">]</span><span class="token punctuation">:</span> ' + model.char <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The QML views know how to handle these different types of models. For models coming from the C++ world, the view expects a specific protocol to be followed. This protocol is defined in the API defined in <code>QAbstractItemModel</code>, together with documentation describing the dynamic behavior. The API was developed for driving views in the desktop widget world and is flexible enough to act as a base for trees, or multi-column tables as well as lists. In QML, we usually use either the list variant of the API, <code>QAbstractListModel</code> or, for the <code>TableView</code> element, the table variant of the API, <code>QAbstractTableModel</code>. The API contains some functions that have to be implemented and some optional ones that extend the capabilities of the model. The optional parts mostly handle the dynamic use cases for changing, adding or deleting data.</p> <h2 id="a-simple-model"><a href="#a-simple-model" class="header-anchor">#</a> A simple model</h2> <p>A typical QML C++ model derives from <code>QAbstractListModel</code> and implements at least the <code>data</code> and <code>rowCount</code> function. In the example below, we will use a series of SVG color names provided by the <code>QColor</code> class and display them using our model. The data is stored into a <code>QList&lt;QString&gt;</code> data container.</p> <p>Our <code>DataEntryModel</code> is derived form <code>QAbstractListModel</code> and implements the mandatory functions. We can ignore the parent in <code>rowCount</code> as this is only used in a tree model. The <code>QModelIndex</code> class provides the row and column information for the cell, for which the view wants to retrieve data. The view is pulling information from the model on a row/column and role-based. The <code>QAbstractListModel</code> is defined in <code>QtCore</code> but <code>QColor</code> in <code>QtGui</code>. That is why we have the additional <code>QtGui</code> dependency. For QML applications it is okay to depend on <code>QtGui</code> but it should normally not depend on <code>QtWidgets</code>.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">DATAENTRYMODEL_H</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">DATAENTRYMODEL_H</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QtCore&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QtGui&gt;</span></span>

<span class="token keyword">class</span> <span class="token class-name">DataEntryModel</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">QAbstractListModel</span></span>
<span class="token punctuation">{</span>
    Q_OBJECT
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">explicit</span> <span class="token function">DataEntryModel</span><span class="token punctuation">(</span>QObject <span class="token operator">*</span>parent <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">DataEntryModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">public</span><span class="token operator">:</span> <span class="token comment">// QAbstractItemModel interface</span>
    <span class="token keyword">virtual</span> <span class="token keyword">int</span> <span class="token function">rowCount</span><span class="token punctuation">(</span><span class="token keyword">const</span> QModelIndex <span class="token operator">&amp;</span>parent<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> QVariant <span class="token function">data</span><span class="token punctuation">(</span><span class="token keyword">const</span> QModelIndex <span class="token operator">&amp;</span>index<span class="token punctuation">,</span> <span class="token keyword">int</span> role<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    QList<span class="token operator">&lt;</span>QString<span class="token operator">&gt;</span> m_data<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// DATAENTRYMODEL_H</span></span>
</code></pre></div><p>On the implementation side, the most complex part is the data function. We first need to make a range check to ensure that we've been provided a valid index. Then we check that the display role is supported. Each item in a model can have multiple display roles defining various aspects of the data contained. The <code>Qt::DisplayRole</code> is the default text role a view will ask for. There is a small set of default roles defined in Qt which can be used, but normally a model will define its own roles for clarity. In the example, all calls which do not contain the display role are ignored at the moment and the default value <code>QVariant()</code> is returned.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;dataentrymodel.h&quot;</span></span>

<span class="token class-name">DataEntryModel</span><span class="token operator">::</span><span class="token function">DataEntryModel</span><span class="token punctuation">(</span>QObject <span class="token operator">*</span>parent<span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token function">QAbstractListModel</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// initialize our data (QList&lt;QString&gt;) with a list of color names</span>
    m_data <span class="token operator">=</span> <span class="token class-name">QColor</span><span class="token operator">::</span><span class="token function">colorNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">DataEntryModel</span><span class="token operator">::</span><span class="token operator">~</span><span class="token function">DataEntryModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token class-name">DataEntryModel</span><span class="token operator">::</span><span class="token function">rowCount</span><span class="token punctuation">(</span><span class="token keyword">const</span> QModelIndex <span class="token operator">&amp;</span>parent<span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{</span>
    <span class="token function">Q_UNUSED</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// return our data count</span>
    <span class="token keyword">return</span> m_data<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

QVariant <span class="token class-name">DataEntryModel</span><span class="token operator">::</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token keyword">const</span> QModelIndex <span class="token operator">&amp;</span>index<span class="token punctuation">,</span> <span class="token keyword">int</span> role<span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{</span>
    <span class="token comment">// the index returns the requested row and column information.</span>
    <span class="token comment">// we ignore the column and only use the row information</span>
    <span class="token keyword">int</span> row <span class="token operator">=</span> index<span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// boundary check for the row</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>row <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> row <span class="token operator">&gt;=</span> m_data<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">QVariant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// A model can return data for different roles.</span>
    <span class="token comment">// The default role is the display role.</span>
    <span class="token comment">// it can be accesses in QML with &quot;model.display&quot;</span>
    <span class="token keyword">switch</span><span class="token punctuation">(</span>role<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> Qt<span class="token operator">::</span>DisplayRole<span class="token operator">:</span>
            <span class="token comment">// Return the color name for the particular row</span>
            <span class="token comment">// Qt automatically converts it to the QVariant type</span>
            <span class="token keyword">return</span> m_data<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// The view asked for other data, just return an empty QVariant</span>
    <span class="token keyword">return</span> <span class="token function">QVariant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The next step would be to register the model with QML using the <code>qmlRegisterType</code> call. This is done inside the <code>main.cpp</code> before the QML file was loaded.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QtGui&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QtQml&gt;</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;dataentrymodel.h&quot;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    QGuiApplication <span class="token function">app</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// register the type DataEntryModel</span>
    <span class="token comment">// under the url &quot;org.example&quot; in version 1.0</span>
    <span class="token comment">// under the name &quot;DataEntryModel&quot;</span>
    qmlRegisterType<span class="token operator">&lt;</span>DataEntryModel<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;org.example&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;DataEntryModel&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    QQmlApplicationEngine engine<span class="token punctuation">;</span>
    engine<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token function">QUrl</span><span class="token punctuation">(</span><span class="token function">QStringLiteral</span><span class="token punctuation">(</span><span class="token string">&quot;qrc:/main.qml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> app<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Now you can access the <code>DataEntryModel</code> using the QML import statement <code>import org.example 1.0</code> and use it just like other QML item <code>DataEntryModel {}</code>.</p> <p>We use this in this example to display a simple list of color entries.</p> <div class="language-qml extra-class"><pre class="language-qml"><code><span class="token keyword">import</span> org.example 1.0

<span class="token class-name">ListView</span> <span class="token punctuation">{</span>
    <span class="token property">id</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">view</span>
    <span class="token property">anchors.fill</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">parent</span>
    <span class="token property">model</span><span class="token punctuation">:</span> <span class="token class-name">DataEntryModel</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token property">delegate</span><span class="token punctuation">:</span> <span class="token class-name">ListDelegate</span> <span class="token punctuation">{</span>
        <span class="token comment">// use the defined model role &quot;display&quot;</span>
        <span class="token property">text</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">model<span class="token punctuation">.</span>display</span>
    <span class="token punctuation">}</span>
    <span class="token property">highlight</span><span class="token punctuation">:</span> <span class="token class-name">ListHighlight</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The <code>ListDelegate</code> is a custom type to display some text. The <code>ListHighlight</code> is just a rectangle. The code was extracted to keep the example compact.</p> <p>The view can now display a list of strings using the C++ model and the display property of the model. It is still very simple, but already usable in QML. Normally the data is provided from outside the model and the model would act as an interface to the view.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>To expose a table of data instead of a list, the <code>QAbstractTableModel</code> is used. The only difference compared to implementing a <code>QAbstractListModel</code> is that you must also provide the <code>columnCount</code> method.</p></div> <h2 id="more-complex-data"><a href="#more-complex-data" class="header-anchor">#</a> More Complex Data</h2> <p>In reality, the model data is often much more complex. So there is a need to define custom roles so that the view can query other data via properties. For example, the model could provide not only the color as a hex string but maybe also the hue, saturation, and brightness from the HSV color model as “model.hue”, “model.saturation” and “model.brightness” in QML.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">ROLEENTRYMODEL_H</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ROLEENTRYMODEL_H</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QtCore&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QtGui&gt;</span></span>

<span class="token keyword">class</span> <span class="token class-name">RoleEntryModel</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">QAbstractListModel</span></span>
<span class="token punctuation">{</span>
    Q_OBJECT
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment">// Define the role names to be used</span>
    <span class="token keyword">enum</span> <span class="token class-name">RoleNames</span> <span class="token punctuation">{</span>
        NameRole <span class="token operator">=</span> Qt<span class="token operator">::</span>UserRole<span class="token punctuation">,</span>
        HueRole <span class="token operator">=</span> Qt<span class="token operator">::</span>UserRole<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">,</span>
        SaturationRole <span class="token operator">=</span> Qt<span class="token operator">::</span>UserRole<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">,</span>
        BrightnessRole <span class="token operator">=</span> Qt<span class="token operator">::</span>UserRole<span class="token operator">+</span><span class="token number">4</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">explicit</span> <span class="token function">RoleEntryModel</span><span class="token punctuation">(</span>QObject <span class="token operator">*</span>parent <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">RoleEntryModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// QAbstractItemModel interface</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">int</span> <span class="token function">rowCount</span><span class="token punctuation">(</span><span class="token keyword">const</span> QModelIndex <span class="token operator">&amp;</span>parent<span class="token punctuation">)</span> <span class="token keyword">const</span> override<span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> QVariant <span class="token function">data</span><span class="token punctuation">(</span><span class="token keyword">const</span> QModelIndex <span class="token operator">&amp;</span>index<span class="token punctuation">,</span> <span class="token keyword">int</span> role<span class="token punctuation">)</span> <span class="token keyword">const</span> override<span class="token punctuation">;</span>
<span class="token keyword">protected</span><span class="token operator">:</span>
    <span class="token comment">// return the roles mapping to be used by QML</span>
    <span class="token keyword">virtual</span> QHash<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> QByteArray<span class="token operator">&gt;</span> <span class="token function">roleNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> override<span class="token punctuation">;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    QList<span class="token operator">&lt;</span>QColor<span class="token operator">&gt;</span> m_data<span class="token punctuation">;</span>
    QHash<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> QByteArray<span class="token operator">&gt;</span> m_roleNames<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// ROLEENTRYMODEL_H</span></span>
</code></pre></div><p>In the header, we added the role mapping to be used for QML. When QML tries now to access a property from the model (e.g. “model.name”) the listview will lookup the mapping for “name” and ask the model for data using the <code>NameRole</code>. User-defined roles should start with <code>Qt::UserRole</code> and need to be unique for each model.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;roleentrymodel.h&quot;</span></span>

<span class="token class-name">RoleEntryModel</span><span class="token operator">::</span><span class="token function">RoleEntryModel</span><span class="token punctuation">(</span>QObject <span class="token operator">*</span>parent<span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token function">QAbstractListModel</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Set names to the role name hash container (QHash&lt;int, QByteArray&gt;)</span>
    <span class="token comment">// model.name, model.hue, model.saturation, model.brightness</span>
    m_roleNames<span class="token punctuation">[</span>NameRole<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">;</span>
    m_roleNames<span class="token punctuation">[</span>HueRole<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;hue&quot;</span><span class="token punctuation">;</span>
    m_roleNames<span class="token punctuation">[</span>SaturationRole<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;saturation&quot;</span><span class="token punctuation">;</span>
    m_roleNames<span class="token punctuation">[</span>BrightnessRole<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;brightness&quot;</span><span class="token punctuation">;</span>

    <span class="token comment">// Append the color names as QColor to the data list (QList&lt;QColor&gt;)</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> QString<span class="token operator">&amp;</span> name <span class="token operator">:</span> <span class="token class-name">QColor</span><span class="token operator">::</span><span class="token function">colorNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        m_data<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token function">QColor</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token class-name">RoleEntryModel</span><span class="token operator">::</span><span class="token operator">~</span><span class="token function">RoleEntryModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token class-name">RoleEntryModel</span><span class="token operator">::</span><span class="token function">rowCount</span><span class="token punctuation">(</span><span class="token keyword">const</span> QModelIndex <span class="token operator">&amp;</span>parent<span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{</span>
    <span class="token function">Q_UNUSED</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> m_data<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

QVariant <span class="token class-name">RoleEntryModel</span><span class="token operator">::</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token keyword">const</span> QModelIndex <span class="token operator">&amp;</span>index<span class="token punctuation">,</span> <span class="token keyword">int</span> role<span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> row <span class="token operator">=</span> index<span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>row <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> row <span class="token operator">&gt;=</span> m_data<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">QVariant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> QColor<span class="token operator">&amp;</span> color <span class="token operator">=</span> m_data<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> row <span class="token operator">&lt;&lt;</span> role <span class="token operator">&lt;&lt;</span> color<span class="token punctuation">;</span>
    <span class="token keyword">switch</span><span class="token punctuation">(</span>role<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> NameRole<span class="token operator">:</span>
        <span class="token comment">// return the color name as hex string (model.name)</span>
        <span class="token keyword">return</span> color<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> HueRole<span class="token operator">:</span>
        <span class="token comment">// return the hue of the color (model.hue)</span>
        <span class="token keyword">return</span> color<span class="token punctuation">.</span><span class="token function">hueF</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> SaturationRole<span class="token operator">:</span>
        <span class="token comment">// return the saturation of the color (model.saturation)</span>
        <span class="token keyword">return</span> color<span class="token punctuation">.</span><span class="token function">saturationF</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> BrightnessRole<span class="token operator">:</span>
        <span class="token comment">// return the brightness of the color (model.brightness)</span>
        <span class="token keyword">return</span> color<span class="token punctuation">.</span><span class="token function">lightnessF</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">QVariant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

QHash<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> QByteArray<span class="token operator">&gt;</span> <span class="token class-name">RoleEntryModel</span><span class="token operator">::</span><span class="token function">roleNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> m_roleNames<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The implementation now has changed only in two places. First in the initialization. We now initialize the data list with QColor data types. Additionally, we define our role name map to be accessible for QML. This map is returned later in the <code>::roleNames</code> function.</p> <p>The second change is in the <code>::data</code> function. We extend the switch to cover the other roles (e.g hue, saturation, brightness). There is no way to return an SVG name from a color, as a color can take any color and SVG names are limited. So we skip this. Storing the names would require to create a structure <code>struct { QColor, QString }</code> to be able to identify the named color.</p> <p>After registering the type we can use the model and its entries in our user interface.</p> <div class="language-qml extra-class"><pre class="language-qml"><code><span class="token class-name">ListView</span> <span class="token punctuation">{</span>
    <span class="token property">id</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">view</span>
    <span class="token property">anchors.fill</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">parent</span>
    <span class="token property">model</span><span class="token punctuation">:</span> <span class="token class-name">RoleEntryModel</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token property">focus</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token boolean">true</span></span>
    <span class="token property">delegate</span><span class="token punctuation">:</span> <span class="token class-name">ListDelegate</span> <span class="token punctuation">{</span>
        <span class="token property">text</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token string">'hsv('</span> <span class="token operator">+</span></span>
              Number(model.hue).toFixed(2) + '<span class="token punctuation">,</span>' +
              Number(model.saturation).toFixed() + '<span class="token punctuation">,</span>' +
              Number(model.brightness).toFixed() + ')'
        <span class="token property">color</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">model<span class="token punctuation">.</span>name</span>
    <span class="token punctuation">}</span>
    <span class="token property">highlight</span><span class="token punctuation">:</span> <span class="token class-name">ListHighlight</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>We convert the returned type to a JS number type to be able to format the number using fixed-point notation. The code would also work without the Number call (e.g. plain <code>model.saturation.toFixed(2)</code>). Which format to choose, depends how much you trust the incoming data.</p> <h2 id="dynamic-data"><a href="#dynamic-data" class="header-anchor">#</a> Dynamic Data</h2> <p>Dynamic data covers the aspects of inserting, removing and clearing the data from the model. The <code>QAbstractListModel</code> expect a certain behavior when entries are removed or inserted. The behavior is expressed in signals which need to be called before and after the manipulation. For example to insert a row into a model you need first to emit the signal <code>beginInsertRows</code>, then manipulate the data and then finally emit <code>endInsertRows</code>.</p> <p>We will add the following functions to our headers. These functions are declared using <code>Q_INVOKABLE</code> to be able to call them from QML. Another way would be to declare them as public slots.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token comment">// inserts a color at the index (0 at begining, count-1 at end)</span>
Q_INVOKABLE <span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">,</span> <span class="token keyword">const</span> QString<span class="token operator">&amp;</span> colorValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// uses insert to insert a color at the end</span>
Q_INVOKABLE <span class="token keyword">void</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">const</span> QString<span class="token operator">&amp;</span> colorValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// removes a color from the index</span>
Q_INVOKABLE <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// clear the whole model (e.g. reset)</span>
Q_INVOKABLE <span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Additionally, we define a <code>count</code> property to get the size of the model and a <code>get</code> method to get a color at the given index. This is useful when you would like to iterate over the model content from QML.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token comment">// gives the size of the model</span>
<span class="token function">Q_PROPERTY</span><span class="token punctuation">(</span><span class="token keyword">int</span> count READ count NOTIFY countChanged<span class="token punctuation">)</span>
<span class="token comment">// gets a color at the index</span>
Q_INVOKABLE QColor <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The implementation for insert checks first the boundaries and if the given value is valid. Only then do we begin inserting the data.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token class-name">DynamicEntryModel</span><span class="token operator">::</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">,</span> <span class="token keyword">const</span> QString <span class="token operator">&amp;</span>colorValue<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>index <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> index <span class="token operator">&gt;</span> m_data<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    QColor <span class="token function">color</span><span class="token punctuation">(</span>colorValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>color<span class="token punctuation">.</span><span class="token function">isValid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// view protocol (begin =&gt; manipulate =&gt; end]</span>
    emit <span class="token function">beginInsertRows</span><span class="token punctuation">(</span><span class="token function">QModelIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    m_data<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> color<span class="token punctuation">)</span><span class="token punctuation">;</span>
    emit <span class="token function">endInsertRows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// update our count property</span>
    emit <span class="token function">countChanged</span><span class="token punctuation">(</span>m_data<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Append is very simple. We reuse the insert function with the size of the model.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token class-name">DynamicEntryModel</span><span class="token operator">::</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">const</span> QString <span class="token operator">&amp;</span>colorValue<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">insert</span><span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> colorValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Remove is similar to insert but it calls according to the remove operation protocol.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token class-name">DynamicEntryModel</span><span class="token operator">::</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>index <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> index <span class="token operator">&gt;=</span> m_data<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    emit <span class="token function">beginRemoveRows</span><span class="token punctuation">(</span><span class="token function">QModelIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    m_data<span class="token punctuation">.</span><span class="token function">removeAt</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    emit <span class="token function">endRemoveRows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// do not forget to update our count property</span>
    emit <span class="token function">countChanged</span><span class="token punctuation">(</span>m_data<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The helper function <code>count</code> is trivial. It just returns the data count. The <code>get</code> function is also quite simple.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>QColor <span class="token class-name">DynamicEntryModel</span><span class="token operator">::</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>index <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> index <span class="token operator">&gt;=</span> m_data<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">QColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> m_data<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>You need to be careful that you only return a value which QML understands. If it is not one of the basic QML types or types known to QML you need to register the type first with <code>qmlRegisterType</code> or <code>qmlRegisterUncreatableType</code>. You use <code>qmlRegisterUncreatableType</code> if the user shall not be able to instantiate its own object in QML.</p> <p>Now you can use the model in QML and insert, append, remove entries from the model. Here is a small example which allows the user to enter a color name or color hex value and the color is then appended onto the model and shown in the list view. The red circle on the delegate allows the user to remove this entry from the model. After the entry is to remove the list view is notified by the model and updates its content.</p> <p><img src="/qt6book/assets/img/modelview.639d2bbd.png" alt="image"></p> <p>And here is the QML code. You find the full source code also in the assets for this chapter. The example uses the <code>QtQuick.Controls</code> and <code>QtQuick.Layout</code> module to make the code more compact. These controls module provides a set of desktop related UI elements in Qt Quick and the layouts module provides some very useful layout managers.</p> <div class="language-qml extra-class"><pre class="language-qml"><code><span class="token keyword">import</span> QtQuick
<span class="token keyword">import</span> QtQuick.Window
<span class="token keyword">import</span> QtQuick.Controls
<span class="token keyword">import</span> QtQuick.Layouts

<span class="token comment">// our module</span>
<span class="token keyword">import</span> org.example 1.0

<span class="token class-name">Window</span> <span class="token punctuation">{</span>
    <span class="token property">visible</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token boolean">true</span></span>
    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">480</span></span>
    <span class="token property">height</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">480</span></span>

    <span class="token class-name">Background</span> <span class="token punctuation">{</span> <span class="token comment">// a dark background</span>
        <span class="token property">id</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">background</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// our dyanmic model</span>
    <span class="token class-name">DynamicEntryModel</span> <span class="token punctuation">{</span>
        <span class="token property">id</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">dynamic</span>
        <span class="token property">onCountChanged</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token punctuation">{</span>
            <span class="token comment">// we print out count and the last entry when count is changing</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'new count: '</span> <span class="token operator">+</span> dynamic<span class="token punctuation">.</span>count<span class="token punctuation">)</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'last entry: '</span> <span class="token operator">+</span> dynamic<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>dynamic<span class="token punctuation">.</span>count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span></span>
    <span class="token punctuation">}</span>

    <span class="token class-name">ColumnLayout</span> <span class="token punctuation">{</span>
        <span class="token property">anchors.fill</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">parent</span>
        <span class="token property">anchors.margins</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">8</span></span>
        <span class="token class-name">ScrollView</span> <span class="token punctuation">{</span>
            <span class="token property">Layout.fillHeight</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token boolean">true</span></span>
            <span class="token property">Layout.fillWidth</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token boolean">true</span></span>
            <span class="token class-name">ListView</span> <span class="token punctuation">{</span>
                <span class="token property">id</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">view</span>
                <span class="token comment">// set our dynamic model to the views model property</span>
                <span class="token property">model</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">dynamic</span>
                <span class="token property">delegate</span><span class="token punctuation">:</span> <span class="token class-name">ListDelegate</span> <span class="token punctuation">{</span>
                    required property var model
                    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">ListView<span class="token punctuation">.</span>view<span class="token punctuation">.</span>width</span>
                    <span class="token comment">// construct a string based on the models proeprties</span>
                    <span class="token property">text</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token string">'hsv('</span> <span class="token operator">+</span></span>
                          Number(model.hue).toFixed(2) + '<span class="token punctuation">,</span>' +
                          Number(model.saturation).toFixed() + '<span class="token punctuation">,</span>' +
                          Number(model.brightness).toFixed() + ')'
                    <span class="token comment">// sets the font color of our custom delegates</span>
                    <span class="token property">color</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">model<span class="token punctuation">.</span>name</span>

                    <span class="token property">onClicked</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token punctuation">{</span>
                        <span class="token comment">// make this delegate the current item</span>
                        view<span class="token punctuation">.</span>currentIndex <span class="token operator">=</span> model<span class="token punctuation">.</span>index
                        view<span class="token punctuation">.</span>focus <span class="token operator">=</span> <span class="token boolean">true</span>
                    <span class="token punctuation">}</span></span>
                    <span class="token property">onRemove</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token punctuation">{</span>
                        <span class="token comment">// remove the current entry from the model</span>
                        dynamic<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span>index<span class="token punctuation">)</span>
                    <span class="token punctuation">}</span></span>
                <span class="token punctuation">}</span>
                <span class="token property">highlight</span><span class="token punctuation">:</span> <span class="token class-name">ListHighlight</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
                <span class="token comment">// some fun with transitions :-)</span>
                <span class="token property">add</span><span class="token punctuation">:</span> <span class="token class-name">Transition</span> <span class="token punctuation">{</span>
                    <span class="token comment">// applied when entry is added</span>
                    <span class="token class-name">NumberAnimation</span> <span class="token punctuation">{</span>
                        <span class="token property">properties</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token string">&quot;x&quot;</span></span><span class="token punctuation">;</span> <span class="token property">from</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token operator">-</span>view<span class="token punctuation">.</span>width</span><span class="token punctuation">;</span>
                        <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">250</span></span><span class="token punctuation">;</span> <span class="token property">easing.type</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">Easing<span class="token punctuation">.</span>InCirc</span>
                    <span class="token punctuation">}</span>
                    <span class="token class-name">NumberAnimation</span> <span class="token punctuation">{</span> <span class="token property">properties</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token string">&quot;y&quot;</span></span><span class="token punctuation">;</span> <span class="token property">from</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">view<span class="token punctuation">.</span>height</span><span class="token punctuation">;</span>
                        <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">250</span></span><span class="token punctuation">;</span> <span class="token property">easing.type</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">Easing<span class="token punctuation">.</span>InCirc</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token property">remove</span><span class="token punctuation">:</span> <span class="token class-name">Transition</span> <span class="token punctuation">{</span>
                    <span class="token comment">// applied when entry is removed</span>
                    <span class="token class-name">NumberAnimation</span> <span class="token punctuation">{</span>
                        <span class="token property">properties</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token string">&quot;x&quot;</span></span><span class="token punctuation">;</span> <span class="token property">to</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">view<span class="token punctuation">.</span>width</span><span class="token punctuation">;</span>
                        <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">250</span></span><span class="token punctuation">;</span> <span class="token property">easing.type</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">Easing<span class="token punctuation">.</span>InBounce</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token property">displaced</span><span class="token punctuation">:</span> <span class="token class-name">Transition</span> <span class="token punctuation">{</span>
                    <span class="token comment">// applied when entry is moved</span>
                    <span class="token comment">// (e.g because another element was removed)</span>
                    <span class="token class-name">SequentialAnimation</span> <span class="token punctuation">{</span>
                        <span class="token comment">// wait until remove has finished</span>
                        <span class="token class-name">PauseAnimation</span> <span class="token punctuation">{</span> <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">250</span> </span><span class="token punctuation">}</span>
                        <span class="token class-name">NumberAnimation</span> <span class="token punctuation">{</span> <span class="token property">properties</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token string">&quot;y&quot;</span></span><span class="token punctuation">;</span> <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">75</span></span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">TextEntry</span> <span class="token punctuation">{</span>
            <span class="token property">id</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">textEntry</span>
            <span class="token property">onAppend</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">color</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// called when the user presses return on the text field</span>
                <span class="token comment">// or clicks the add button</span>
                dynamic<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span>
            <span class="token punctuation">}</span></span>

            <span class="token property">onUp</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token punctuation">{</span>
                <span class="token comment">// called when the user presses up while the text field is focused</span>
                view<span class="token punctuation">.</span><span class="token function">decrementCurrentIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span></span>
            <span class="token property">onDown</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token punctuation">{</span>
                <span class="token comment">// same for down</span>
                view<span class="token punctuation">.</span><span class="token function">incrementCurrentIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span></span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div><p>Model view programming is one of the more complex development tasks in Qt. It is one of the very few classes where you have to implement an interface as a normal application developer. All other classes you just use normally. The sketching of models should always start on the QML side. You should envision how your users would use your model inside QML. For this, it is often a good idea to create a prototype first using the <code>ListModel</code> to see how this best works in QML. This is also true when it comes to defining QML APIs. Making data available from C++ to QML is not only a technology boundary it is also a programming paradigm change from imperative to declarative style programming. So be prepared for some setbacks and aha moments:-).</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/dogifyc/qt6book/edit/main/docs/ch17-qtcpp/cpp-models.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/qt6book/ch17-qtcpp/common-classes.html" class="prev">
        Common Qt Classes
      </a></span> <span class="next"><a href="/qt6book/ch18-extensions/extending-qml.html">
        Extending QML with C++
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/qt6book/assets/js/app.49f675f8.js" defer></script><script src="/qt6book/assets/js/2.ea318f3c.js" defer></script><script src="/qt6book/assets/js/75.fa040cbb.js" defer></script>
  </body>
</html>
