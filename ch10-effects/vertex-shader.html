<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vertex Shader | Qt 6 书籍</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="一本关于 QML 的书">
    
    <link rel="preload" href="/qt6book/assets/css/0.styles.fdf3cb50.css" as="style"><link rel="preload" href="/qt6book/assets/js/app.49f675f8.js" as="script"><link rel="preload" href="/qt6book/assets/js/2.ea318f3c.js" as="script"><link rel="preload" href="/qt6book/assets/js/6.381344fb.js" as="script"><link rel="prefetch" href="/qt6book/assets/js/10.70a34b30.js"><link rel="prefetch" href="/qt6book/assets/js/100.cff7a886.js"><link rel="prefetch" href="/qt6book/assets/js/101.503e20ce.js"><link rel="prefetch" href="/qt6book/assets/js/102.395792fa.js"><link rel="prefetch" href="/qt6book/assets/js/103.071d8b78.js"><link rel="prefetch" href="/qt6book/assets/js/104.f33ee0ed.js"><link rel="prefetch" href="/qt6book/assets/js/105.bb2168fe.js"><link rel="prefetch" href="/qt6book/assets/js/106.0e951818.js"><link rel="prefetch" href="/qt6book/assets/js/107.a51bd278.js"><link rel="prefetch" href="/qt6book/assets/js/108.eefe809c.js"><link rel="prefetch" href="/qt6book/assets/js/109.744ac99b.js"><link rel="prefetch" href="/qt6book/assets/js/11.82909cde.js"><link rel="prefetch" href="/qt6book/assets/js/110.11ad155f.js"><link rel="prefetch" href="/qt6book/assets/js/111.56537df6.js"><link rel="prefetch" href="/qt6book/assets/js/112.628464f9.js"><link rel="prefetch" href="/qt6book/assets/js/113.893d1439.js"><link rel="prefetch" href="/qt6book/assets/js/114.c00f3590.js"><link rel="prefetch" href="/qt6book/assets/js/115.319d8826.js"><link rel="prefetch" href="/qt6book/assets/js/116.a36dfadb.js"><link rel="prefetch" href="/qt6book/assets/js/117.24dc552e.js"><link rel="prefetch" href="/qt6book/assets/js/118.8bc8de4e.js"><link rel="prefetch" href="/qt6book/assets/js/119.bb5fbbd6.js"><link rel="prefetch" href="/qt6book/assets/js/12.7c20b914.js"><link rel="prefetch" href="/qt6book/assets/js/120.63c90b9f.js"><link rel="prefetch" href="/qt6book/assets/js/121.64979c23.js"><link rel="prefetch" href="/qt6book/assets/js/122.410ce3c2.js"><link rel="prefetch" href="/qt6book/assets/js/123.3ceaa95e.js"><link rel="prefetch" href="/qt6book/assets/js/124.78e05194.js"><link rel="prefetch" href="/qt6book/assets/js/125.6d9b2679.js"><link rel="prefetch" href="/qt6book/assets/js/126.77bf1e01.js"><link rel="prefetch" href="/qt6book/assets/js/127.d3b82f75.js"><link rel="prefetch" href="/qt6book/assets/js/128.9d705e68.js"><link rel="prefetch" href="/qt6book/assets/js/129.37f588a9.js"><link rel="prefetch" href="/qt6book/assets/js/13.44fdf993.js"><link rel="prefetch" href="/qt6book/assets/js/130.93765866.js"><link rel="prefetch" href="/qt6book/assets/js/131.12d0d18e.js"><link rel="prefetch" href="/qt6book/assets/js/132.f488195c.js"><link rel="prefetch" href="/qt6book/assets/js/133.6ef1565d.js"><link rel="prefetch" href="/qt6book/assets/js/134.f3e8c361.js"><link rel="prefetch" href="/qt6book/assets/js/135.b397c9b2.js"><link rel="prefetch" href="/qt6book/assets/js/136.7da1e551.js"><link rel="prefetch" href="/qt6book/assets/js/137.357076e2.js"><link rel="prefetch" href="/qt6book/assets/js/138.42b20678.js"><link rel="prefetch" href="/qt6book/assets/js/139.21e63093.js"><link rel="prefetch" href="/qt6book/assets/js/14.b10bffa3.js"><link rel="prefetch" href="/qt6book/assets/js/140.dfcc4732.js"><link rel="prefetch" href="/qt6book/assets/js/141.6317fc32.js"><link rel="prefetch" href="/qt6book/assets/js/142.288153ef.js"><link rel="prefetch" href="/qt6book/assets/js/143.4eff9ad0.js"><link rel="prefetch" href="/qt6book/assets/js/144.39149a0f.js"><link rel="prefetch" href="/qt6book/assets/js/145.ce392d81.js"><link rel="prefetch" href="/qt6book/assets/js/15.f918e179.js"><link rel="prefetch" href="/qt6book/assets/js/16.5d3c40fb.js"><link rel="prefetch" href="/qt6book/assets/js/17.2614a8fe.js"><link rel="prefetch" href="/qt6book/assets/js/18.b8e87e84.js"><link rel="prefetch" href="/qt6book/assets/js/19.cb8358b7.js"><link rel="prefetch" href="/qt6book/assets/js/20.a509c2f7.js"><link rel="prefetch" href="/qt6book/assets/js/21.fac41553.js"><link rel="prefetch" href="/qt6book/assets/js/22.b8bb6616.js"><link rel="prefetch" href="/qt6book/assets/js/23.ec36efe8.js"><link rel="prefetch" href="/qt6book/assets/js/24.a38239b6.js"><link rel="prefetch" href="/qt6book/assets/js/25.6ec5c6a5.js"><link rel="prefetch" href="/qt6book/assets/js/26.3f43459b.js"><link rel="prefetch" href="/qt6book/assets/js/27.b4de3c2a.js"><link rel="prefetch" href="/qt6book/assets/js/28.3d1a74fb.js"><link rel="prefetch" href="/qt6book/assets/js/29.0e1f197c.js"><link rel="prefetch" href="/qt6book/assets/js/3.112743a2.js"><link rel="prefetch" href="/qt6book/assets/js/30.69e1ba2b.js"><link rel="prefetch" href="/qt6book/assets/js/31.180e6ae8.js"><link rel="prefetch" href="/qt6book/assets/js/32.95f52d7a.js"><link rel="prefetch" href="/qt6book/assets/js/33.19531560.js"><link rel="prefetch" href="/qt6book/assets/js/34.1b2d9f18.js"><link rel="prefetch" href="/qt6book/assets/js/35.10c030c6.js"><link rel="prefetch" href="/qt6book/assets/js/36.51dde79c.js"><link rel="prefetch" href="/qt6book/assets/js/37.f955e155.js"><link rel="prefetch" href="/qt6book/assets/js/38.c5b68607.js"><link rel="prefetch" href="/qt6book/assets/js/39.28538ce3.js"><link rel="prefetch" href="/qt6book/assets/js/4.6ee77bf2.js"><link rel="prefetch" href="/qt6book/assets/js/40.c0ad21c1.js"><link rel="prefetch" href="/qt6book/assets/js/41.105e2872.js"><link rel="prefetch" href="/qt6book/assets/js/42.55911116.js"><link rel="prefetch" href="/qt6book/assets/js/43.8e441a9e.js"><link rel="prefetch" href="/qt6book/assets/js/44.35b2ff29.js"><link rel="prefetch" href="/qt6book/assets/js/45.7d1d010c.js"><link rel="prefetch" href="/qt6book/assets/js/46.7585557d.js"><link rel="prefetch" href="/qt6book/assets/js/47.450265aa.js"><link rel="prefetch" href="/qt6book/assets/js/48.f236e58d.js"><link rel="prefetch" href="/qt6book/assets/js/49.85eb3fbd.js"><link rel="prefetch" href="/qt6book/assets/js/5.c6d72f08.js"><link rel="prefetch" href="/qt6book/assets/js/50.0196025d.js"><link rel="prefetch" href="/qt6book/assets/js/51.1a5823e9.js"><link rel="prefetch" href="/qt6book/assets/js/52.83e09db4.js"><link rel="prefetch" href="/qt6book/assets/js/53.dedb04ac.js"><link rel="prefetch" href="/qt6book/assets/js/54.80561be2.js"><link rel="prefetch" href="/qt6book/assets/js/55.d2a21221.js"><link rel="prefetch" href="/qt6book/assets/js/56.564ff842.js"><link rel="prefetch" href="/qt6book/assets/js/57.757d907a.js"><link rel="prefetch" href="/qt6book/assets/js/58.50225fe8.js"><link rel="prefetch" href="/qt6book/assets/js/59.9e233383.js"><link rel="prefetch" href="/qt6book/assets/js/60.04d29815.js"><link rel="prefetch" href="/qt6book/assets/js/61.0c74ecb4.js"><link rel="prefetch" href="/qt6book/assets/js/62.d5c85dcf.js"><link rel="prefetch" href="/qt6book/assets/js/63.8775d8a6.js"><link rel="prefetch" href="/qt6book/assets/js/64.d6548a41.js"><link rel="prefetch" href="/qt6book/assets/js/65.9ab78926.js"><link rel="prefetch" href="/qt6book/assets/js/66.cd7855b2.js"><link rel="prefetch" href="/qt6book/assets/js/67.1ff5900b.js"><link rel="prefetch" href="/qt6book/assets/js/68.74f0245e.js"><link rel="prefetch" href="/qt6book/assets/js/69.1b2e800d.js"><link rel="prefetch" href="/qt6book/assets/js/7.53dffc97.js"><link rel="prefetch" href="/qt6book/assets/js/70.19fafa64.js"><link rel="prefetch" href="/qt6book/assets/js/71.aca6355b.js"><link rel="prefetch" href="/qt6book/assets/js/72.1a3808cd.js"><link rel="prefetch" href="/qt6book/assets/js/73.de73d4a5.js"><link rel="prefetch" href="/qt6book/assets/js/74.4f6fdc1a.js"><link rel="prefetch" href="/qt6book/assets/js/75.fa040cbb.js"><link rel="prefetch" href="/qt6book/assets/js/76.c943dcfb.js"><link rel="prefetch" href="/qt6book/assets/js/77.5e5240a0.js"><link rel="prefetch" href="/qt6book/assets/js/78.4352cfdb.js"><link rel="prefetch" href="/qt6book/assets/js/79.64132667.js"><link rel="prefetch" href="/qt6book/assets/js/8.a29b933c.js"><link rel="prefetch" href="/qt6book/assets/js/80.99cf0f52.js"><link rel="prefetch" href="/qt6book/assets/js/81.8dc9b0d5.js"><link rel="prefetch" href="/qt6book/assets/js/82.e60a2b4d.js"><link rel="prefetch" href="/qt6book/assets/js/83.ff48a41f.js"><link rel="prefetch" href="/qt6book/assets/js/84.72db517a.js"><link rel="prefetch" href="/qt6book/assets/js/85.876eef38.js"><link rel="prefetch" href="/qt6book/assets/js/86.5ed4ad32.js"><link rel="prefetch" href="/qt6book/assets/js/87.8df5143a.js"><link rel="prefetch" href="/qt6book/assets/js/88.94bf0081.js"><link rel="prefetch" href="/qt6book/assets/js/89.0272804b.js"><link rel="prefetch" href="/qt6book/assets/js/9.7436ab3c.js"><link rel="prefetch" href="/qt6book/assets/js/90.871c44c7.js"><link rel="prefetch" href="/qt6book/assets/js/91.c38e4ee7.js"><link rel="prefetch" href="/qt6book/assets/js/92.d79de636.js"><link rel="prefetch" href="/qt6book/assets/js/93.81493d9a.js"><link rel="prefetch" href="/qt6book/assets/js/94.4eef95b9.js"><link rel="prefetch" href="/qt6book/assets/js/95.3804e65e.js"><link rel="prefetch" href="/qt6book/assets/js/96.360acf76.js"><link rel="prefetch" href="/qt6book/assets/js/97.6a742d1c.js"><link rel="prefetch" href="/qt6book/assets/js/98.7e121e3a.js"><link rel="prefetch" href="/qt6book/assets/js/99.86b18043.js">
    <link rel="stylesheet" href="/qt6book/assets/css/0.styles.fdf3cb50.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/qt6book/" class="home-link router-link-active"><!----> <span class="site-name">Qt 6 书籍</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/dogifyc/qt6book" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/dogifyc/qt6book" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/qt6book/preface/preface" class="sidebar-heading clickable"><span>前言</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/preface/preface.html" class="sidebar-link">欢迎！</a></li><li><a href="/qt6book/preface/acknowledgements.html" class="sidebar-link">鸣谢</a></li><li><a href="/qt6book/preface/authors.html" class="sidebar-link">作者</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch01-meetqt/meet-qt" class="sidebar-heading clickable"><span>遇见 Qt</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch01-meetqt/meet-qt.html" class="sidebar-link">Qt 和 Qt Quick</a></li><li><a href="/qt6book/ch01-meetqt/blocks.html" class="sidebar-link">Qt 构成</a></li><li><a href="/qt6book/ch01-meetqt/intro.html" class="sidebar-link">Qt 6 简介</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch02-start/quick-start" class="sidebar-heading clickable"><span>起步</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch02-start/quick-start.html" class="sidebar-link">快速开始</a></li><li><a href="/qt6book/ch02-start/install.html" class="sidebar-link">安装 Qt 6 SDK</a></li><li><a href="/qt6book/ch02-start/hello-world.html" class="sidebar-link">Hello World</a></li><li><a href="/qt6book/ch02-start/app-types.html" class="sidebar-link">应用类型</a></li><li><a href="/qt6book/ch02-start/summary.html" class="sidebar-link">摘要</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch03-qtcreator/qt-creator" class="sidebar-heading clickable"><span>Qt Creator IDE</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch03-qtcreator/qt-creator.html" class="sidebar-link">Qt Creator IDE</a></li><li><a href="/qt6book/ch03-qtcreator/user-interface.html" class="sidebar-link">用户界面</a></li><li><a href="/qt6book/ch03-qtcreator/kit-registry.html" class="sidebar-link">注册 Qt 套件</a></li><li><a href="/qt6book/ch03-qtcreator/projects.html" class="sidebar-link">项目管理</a></li><li><a href="/qt6book/ch03-qtcreator/editor.html" class="sidebar-link">使用编辑器</a></li><li><a href="/qt6book/ch03-qtcreator/locator.html" class="sidebar-link">定位器</a></li><li><a href="/qt6book/ch03-qtcreator/debugging.html" class="sidebar-link">调试</a></li><li><a href="/qt6book/ch03-qtcreator/shortcuts.html" class="sidebar-link">快捷键</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch04-qmlstart/quick-start" class="sidebar-heading clickable"><span>快速开始</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch04-qmlstart/quick-start.html" class="sidebar-link">快速开始</a></li><li><a href="/qt6book/ch04-qmlstart/qml-syntax.html" class="sidebar-link">QML 语法</a></li><li><a href="/qt6book/ch04-qmlstart/core-elements.html" class="sidebar-link">核心元素</a></li><li><a href="/qt6book/ch04-qmlstart/components.html" class="sidebar-link">组件</a></li><li><a href="/qt6book/ch04-qmlstart/transformations.html" class="sidebar-link">简单变化</a></li><li><a href="/qt6book/ch04-qmlstart/positioning.html" class="sidebar-link">定位元素</a></li><li><a href="/qt6book/ch04-qmlstart/layout.html" class="sidebar-link">布局元素</a></li><li><a href="/qt6book/ch04-qmlstart/input.html" class="sidebar-link">输入元素</a></li><li><a href="/qt6book/ch04-qmlstart/advanced.html" class="sidebar-link">进阶技巧</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch05-fluid/fluid-elements" class="sidebar-heading clickable"><span>流式元素</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch05-fluid/fluid-elements.html" class="sidebar-link">流式元素</a></li><li><a href="/qt6book/ch05-fluid/animations.html" class="sidebar-link">动画</a></li><li><a href="/qt6book/ch05-fluid/states-transitions.html" class="sidebar-link">状态和过渡</a></li><li><a href="/qt6book/ch05-fluid/advanced.html" class="sidebar-link">进阶技巧</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch06-controls/controls2" class="sidebar-heading clickable"><span>QtQuick Controls</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch06-controls/controls2.html" class="sidebar-link">UI Controls</a></li><li><a href="/qt6book/ch06-controls/introduction.html" class="sidebar-link">Controls 简介</a></li><li><a href="/qt6book/ch06-controls/image-viewer.html" class="sidebar-link">Image 查看器</a></li><li><a href="/qt6book/ch06-controls/common-patterns.html" class="sidebar-link">Common Patterns</a></li><li><a href="/qt6book/ch06-controls/imagine-style.html" class="sidebar-link">The Imagine Style</a></li><li><a href="/qt6book/ch06-controls/summary.html" class="sidebar-link">Summary</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch07-modelview/model-view" class="sidebar-heading clickable"><span>Model View</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch07-modelview/model-view.html" class="sidebar-link">Model-View-Delegate</a></li><li><a href="/qt6book/ch07-modelview/concept.html" class="sidebar-link">Concept</a></li><li><a href="/qt6book/ch07-modelview/basic-models.html" class="sidebar-link">Basic Models</a></li><li><a href="/qt6book/ch07-modelview/dynamic-views.html" class="sidebar-link">Dynamic Views</a></li><li><a href="/qt6book/ch07-modelview/delegate.html" class="sidebar-link">Delegate</a></li><li><a href="/qt6book/ch07-modelview/advanced.html" class="sidebar-link">Advanced Techniques</a></li><li><a href="/qt6book/ch07-modelview/summary.html" class="sidebar-link">Summary</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch08-canvas/canvas-element" class="sidebar-heading clickable"><span>Canvas</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch08-canvas/canvas-element.html" class="sidebar-link">Canvas Element</a></li><li><a href="/qt6book/ch08-canvas/convenience-api.html" class="sidebar-link">Convenience API</a></li><li><a href="/qt6book/ch08-canvas/gradients.html" class="sidebar-link">Gradients</a></li><li><a href="/qt6book/ch08-canvas/shadows.html" class="sidebar-link">Shadows</a></li><li><a href="/qt6book/ch08-canvas/images.html" class="sidebar-link">Images</a></li><li><a href="/qt6book/ch08-canvas/transformation.html" class="sidebar-link">Transformation</a></li><li><a href="/qt6book/ch08-canvas/composition-modes.html" class="sidebar-link">Composition Modes</a></li><li><a href="/qt6book/ch08-canvas/pixel-buffer.html" class="sidebar-link">Pixel Buffers</a></li><li><a href="/qt6book/ch08-canvas/canvas-paint.html" class="sidebar-link">Canvas Paint</a></li><li><a href="/qt6book/ch08-canvas/port-from-html.html" class="sidebar-link">Porting from HTML5 Canvas</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch09-shapes/shapes" class="sidebar-heading clickable"><span>Shapes</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch09-shapes/shapes.html" class="sidebar-link">Shapes</a></li><li><a href="/qt6book/ch09-shapes/basics.html" class="sidebar-link">A Basic Shape</a></li><li><a href="/qt6book/ch09-shapes/paths.html" class="sidebar-link">Building Paths</a></li><li><a href="/qt6book/ch09-shapes/gradients.html" class="sidebar-link">Filling Shapes</a></li><li><a href="/qt6book/ch09-shapes/animations.html" class="sidebar-link">Animating Shapes</a></li><li><a href="/qt6book/ch09-shapes/summary.html" class="sidebar-link">Summary</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch10-effects/effects" class="sidebar-heading clickable open"><span>Effects</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch10-effects/effects.html" class="sidebar-link">Effects in QML</a></li><li><a href="/qt6book/ch10-effects/particles.html" class="sidebar-link">Particle Concept</a></li><li><a href="/qt6book/ch10-effects/simple-simulation.html" class="sidebar-link">Simple Simulation</a></li><li><a href="/qt6book/ch10-effects/particle-parameters.html" class="sidebar-link">Particle Parameters</a></li><li><a href="/qt6book/ch10-effects/directed-particles.html" class="sidebar-link">Directed Particles</a></li><li><a href="/qt6book/ch10-effects/affecting-particles.html" class="sidebar-link">Affecting Particles</a></li><li><a href="/qt6book/ch10-effects/particle-groups.html" class="sidebar-link">Particle Groups</a></li><li><a href="/qt6book/ch10-effects/particle-painters.html" class="sidebar-link">Particle Painters</a></li><li><a href="/qt6book/ch10-effects/opengl-shaders.html" class="sidebar-link">Graphics Shaders</a></li><li><a href="/qt6book/ch10-effects/shader-elements.html" class="sidebar-link">Shader Elements</a></li><li><a href="/qt6book/ch10-effects/fragment-shaders.html" class="sidebar-link">Fragment Shaders</a></li><li><a href="/qt6book/ch10-effects/wave-effect.html" class="sidebar-link">Wave Effect</a></li><li><a href="/qt6book/ch10-effects/vertex-shader.html" aria-current="page" class="active sidebar-link">Vertex Shader</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/qt6book/ch10-effects/vertex-shader.html#setting-up-the-scene" class="sidebar-link">Setting up the scene</a></li><li class="sidebar-sub-header"><a href="/qt6book/ch10-effects/vertex-shader.html#minimize-and-normalize" class="sidebar-link">Minimize and normalize</a></li><li class="sidebar-sub-header"><a href="/qt6book/ch10-effects/vertex-shader.html#primitive-bending" class="sidebar-link">Primitive Bending</a></li><li class="sidebar-sub-header"><a href="/qt6book/ch10-effects/vertex-shader.html#better-bending" class="sidebar-link">Better Bending</a></li><li class="sidebar-sub-header"><a href="/qt6book/ch10-effects/vertex-shader.html#choosing-sides" class="sidebar-link">Choosing Sides</a></li><li class="sidebar-sub-header"><a href="/qt6book/ch10-effects/vertex-shader.html#packaging" class="sidebar-link">Packaging</a></li></ul></li><li><a href="/qt6book/ch10-effects/curtain-effect.html" class="sidebar-link">Curtain Effect</a></li><li><a href="/qt6book/ch10-effects/summary.html" class="sidebar-link">Summary</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch11-multimedia/multimedia" class="sidebar-heading clickable"><span>Multimedia</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch11-multimedia/multimedia.html" class="sidebar-link">Multimedia</a></li><li><a href="/qt6book/ch11-multimedia/playing-media.html" class="sidebar-link">Playing Media</a></li><li><a href="/qt6book/ch11-multimedia/sound-effects.html" class="sidebar-link">Sound Effects</a></li><li><a href="/qt6book/ch11-multimedia/video-streams.html" class="sidebar-link">Video Streams</a></li><li><a href="/qt6book/ch11-multimedia/capturing-images.html" class="sidebar-link">Capturing Images</a></li><li><a href="/qt6book/ch11-multimedia/summary.html" class="sidebar-link">Summary</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch12-qtquick3d/intro" class="sidebar-heading clickable"><span>Qt Quick 3D</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch12-qtquick3d/intro.html" class="sidebar-link">Qt Quick 3D</a></li><li><a href="/qt6book/ch12-qtquick3d/basics.html" class="sidebar-link">The Basics</a></li><li><a href="/qt6book/ch12-qtquick3d/assets.html" class="sidebar-link">Working with Assets</a></li><li><a href="/qt6book/ch12-qtquick3d/materials-and-light.html" class="sidebar-link">Materials and Light</a></li><li><a href="/qt6book/ch12-qtquick3d/animations.html" class="sidebar-link">Animations</a></li><li><a href="/qt6book/ch12-qtquick3d/mixing-2d-and-3d.html" class="sidebar-link">Mixing 2D and 3D Contents</a></li><li><a href="/qt6book/ch12-qtquick3d/summary.html" class="sidebar-link">Summary</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch13-networking/networking" class="sidebar-heading clickable"><span>Networking</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch13-networking/networking.html" class="sidebar-link">Networking</a></li><li><a href="/qt6book/ch13-networking/serve-qml.html" class="sidebar-link">Serving UI via HTTP</a></li><li><a href="/qt6book/ch13-networking/templates.html" class="sidebar-link">Templates</a></li><li><a href="/qt6book/ch13-networking/http-requests.html" class="sidebar-link">HTTP Requests</a></li><li><a href="/qt6book/ch13-networking/local-files.html" class="sidebar-link">Local files</a></li><li><a href="/qt6book/ch13-networking/rest-api.html" class="sidebar-link">REST API</a></li><li><a href="/qt6book/ch13-networking/authentication.html" class="sidebar-link">Authentication using OAuth</a></li><li><a href="/qt6book/ch13-networking/web-sockets.html" class="sidebar-link">Web Sockets</a></li><li><a href="/qt6book/ch13-networking/summary.html" class="sidebar-link">Summary</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch14-storage/storage" class="sidebar-heading clickable"><span>Storage</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch14-storage/storage.html" class="sidebar-link">Storage</a></li><li><a href="/qt6book/ch14-storage/settings.html" class="sidebar-link">Settings</a></li><li><a href="/qt6book/ch14-storage/local-storage.html" class="sidebar-link">Local Storage - SQL</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch15-dynamicqml/dynamic-qml" class="sidebar-heading clickable"><span>Dynamic QML</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch15-dynamicqml/dynamic-qml.html" class="sidebar-link">Dynamic QML</a></li><li><a href="/qt6book/ch15-dynamicqml/loading-components.html" class="sidebar-link">Loading Components Dynamically</a></li><li><a href="/qt6book/ch15-dynamicqml/dynamic-objects.html" class="sidebar-link">Creating and Destroying Objects</a></li><li><a href="/qt6book/ch15-dynamicqml/tracking-objects.html" class="sidebar-link">Tracking Dynamic Objects</a></li><li><a href="/qt6book/ch15-dynamicqml/summary.html" class="sidebar-link">Summary</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch16-javascript/javascript" class="sidebar-heading clickable"><span>Javascript</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch16-javascript/javascript.html" class="sidebar-link">JavaScript</a></li><li><a href="/qt6book/ch16-javascript/html-qml.html" class="sidebar-link">Browser/HTML vs Qt Quick/QML</a></li><li><a href="/qt6book/ch16-javascript/js-language.html" class="sidebar-link">JS Language</a></li><li><a href="/qt6book/ch16-javascript/js-objects.html" class="sidebar-link">JS Objects</a></li><li><a href="/qt6book/ch16-javascript/js-console.html" class="sidebar-link">Creating a JS Console</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch17-qtcpp/qtcpp" class="sidebar-heading clickable"><span>Qt C++</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch17-qtcpp/qtcpp.html" class="sidebar-link">Qt and C++</a></li><li><a href="/qt6book/ch17-qtcpp/boilerplate.html" class="sidebar-link">A Boilerplate Application</a></li><li><a href="/qt6book/ch17-qtcpp/qobject.html" class="sidebar-link">The QObject</a></li><li><a href="/qt6book/ch17-qtcpp/build-system.html" class="sidebar-link">Build Systems</a></li><li><a href="/qt6book/ch17-qtcpp/common-classes.html" class="sidebar-link">Common Qt Classes</a></li><li><a href="/qt6book/ch17-qtcpp/cpp-models.html" class="sidebar-link">Models in C++</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch18-extensions/extending-qml" class="sidebar-heading clickable"><span>Extending QML</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch18-extensions/extending-qml.html" class="sidebar-link">Extending QML with C++</a></li><li><a href="/qt6book/ch18-extensions/qml-runtime.html" class="sidebar-link">Understanding the QML Run-time</a></li><li><a href="/qt6book/ch18-extensions/plugin-content.html" class="sidebar-link">Plugin Content</a></li><li><a href="/qt6book/ch18-extensions/create-plugin.html" class="sidebar-link">Creating the plugin</a></li><li><a href="/qt6book/ch18-extensions/fileio-demo.html" class="sidebar-link">FileIO Implementation</a></li><li><a href="/qt6book/ch18-extensions/using-fileio.html" class="sidebar-link">Using FileIO</a></li><li><a href="/qt6book/ch18-extensions/summary.html" class="sidebar-link">Summary</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch19-python/qt-python" class="sidebar-heading clickable"><span>Qt for Python</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch19-python/qt-python.html" class="sidebar-link">Qt for Python</a></li><li><a href="/qt6book/ch19-python/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/qt6book/ch19-python/installing.html" class="sidebar-link">Installing</a></li><li><a href="/qt6book/ch19-python/build-app.html" class="sidebar-link">Building an Application</a></li><li><a href="/qt6book/ch19-python/limitations.html" class="sidebar-link">Limitations</a></li><li><a href="/qt6book/ch19-python/summary.html" class="sidebar-link">Summary</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/qt6book/ch20-qtformcu/qtformcu" class="sidebar-heading clickable"><span>Qt for MCUs</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/qt6book/ch20-qtformcu/qtformcu.html" class="sidebar-link">Qt for MCUs</a></li><li><a href="/qt6book/ch20-qtformcu/setup.html" class="sidebar-link">Setup</a></li><li><a href="/qt6book/ch20-qtformcu/helloworld.html" class="sidebar-link">Hello World - for MCUs</a></li><li><a href="/qt6book/ch20-qtformcu/cpp.html" class="sidebar-link">Integrating with C++</a></li><li><a href="/qt6book/ch20-qtformcu/models.html" class="sidebar-link">Working with Models</a></li><li><a href="/qt6book/ch20-qtformcu/summary.html" class="sidebar-link">Summary</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vertex-shader"><a href="#vertex-shader" class="header-anchor">#</a> Vertex Shader</h1> <p>The vertex shader can be used to manipulate the vertexes provided by the shader effect. In normal cases, the shader effect has 4 vertexes (top-left, top-right, bottom-left and bottom-right). Each vertex reported is from type <code>vec4</code>. To visualize the vertex shader we will program a genie effect. This effect is used to let a rectangular window area vanish into one point, like a genie disappearing into a lamp.</p> <p><img src="/qt6book/assets/img/genieeffect.61728a9a.png" alt="image"></p> <h2 id="setting-up-the-scene"><a href="#setting-up-the-scene" class="header-anchor">#</a> Setting up the scene</h2> <p>First, we will set up our scene with an image and a shader effect.</p> <div class="language-qml extra-class"><pre class="language-qml"><code><span class="token keyword">import</span> QtQuick

<span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">480</span></span><span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">240</span></span>
    <span class="token property">color</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token string">'#1e1e1e'</span></span>

    <span class="token class-name">Image</span> <span class="token punctuation">{</span>
        <span class="token property">id</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">sourceImage</span>
        <span class="token property">width</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">160</span></span><span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">width</span>
        <span class="token property">source</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token string">&quot;../../assets/lighthouse.jpg&quot;</span></span>
        <span class="token property">visible</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token boolean">false</span></span>
    <span class="token punctuation">}</span>
    <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
        <span class="token property">width</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">160</span></span><span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">width</span>
        <span class="token property">anchors.centerIn</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">parent</span>
        <span class="token property">color</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token string">'#333333'</span></span>
    <span class="token punctuation">}</span>
    <span class="token class-name">ShaderEffect</span> <span class="token punctuation">{</span>
        <span class="token property">id</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">genieEffect</span>
        <span class="token property">width</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">160</span></span><span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">width</span>
        <span class="token property">anchors.centerIn</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">parent</span>
        <span class="token property"><span class="token keyword">property</span> <span class="token property">variant</span> <span class="token property">source</span></span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">sourceImage</span>
        <span class="token property"><span class="token keyword">property</span> <span class="token property">bool</span> <span class="token property">minimized</span></span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token boolean">false</span></span>
        <span class="token class-name">MouseArea</span> <span class="token punctuation">{</span>
            <span class="token property">anchors.fill</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">parent</span>
            <span class="token property">onClicked</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">genieEffect<span class="token punctuation">.</span>minimized <span class="token operator">=</span> <span class="token operator">!</span>genieEffect<span class="token punctuation">.</span>minimized</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div><p>This provides a scene with a dark background and a shader effect using an image as the source texture. The original image is not visible on the image produced by our genie effect. Additional we added a dark rectangle on the same geometry as the shader effect so we can better detect where we need to click to revert the effect.</p> <p><img src="/qt6book/assets/img/geniescene.0265247f.png" alt="image"></p> <p>The effect is triggered by clicking on the image, this is defined by the mouse area covering the effect. In the <em>onClicked</em> handler we toggle the custom boolean property <em>minimized</em>. We will use this property later to toggle the effect.</p> <h2 id="minimize-and-normalize"><a href="#minimize-and-normalize" class="header-anchor">#</a> Minimize and normalize</h2> <p>After we have set up the scene, we define a property of type real called <em>minimize</em>, the property will contain the current value of our minimization. The value will vary from 0.0 to 1.0 and is controlled by a sequential animation.</p> <div class="language-qml extra-class"><pre class="language-qml"><code><span class="token property"><span class="token keyword">property</span> <span class="token property">real</span> <span class="token property">minimize</span></span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">0.0</span></span>

<span class="token class-name">SequentialAnimation</span> <span class="token keyword">on</span> minimize <span class="token punctuation">{</span>
    <span class="token property">id</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">animMinimize</span>
    <span class="token property">running</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">genieEffect<span class="token punctuation">.</span>minimized</span>
    <span class="token class-name">PauseAnimation</span> <span class="token punctuation">{</span> <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">300</span> </span><span class="token punctuation">}</span>
    <span class="token class-name">NumberAnimation</span> <span class="token punctuation">{</span> <span class="token property">to</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">1</span></span><span class="token punctuation">;</span> <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">700</span></span><span class="token punctuation">;</span> <span class="token property">easing.type</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">Easing<span class="token punctuation">.</span>InOutSine </span><span class="token punctuation">}</span>
    <span class="token class-name">PauseAnimation</span> <span class="token punctuation">{</span> <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">1000</span> </span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token class-name">SequentialAnimation</span> <span class="token keyword">on</span> minimize <span class="token punctuation">{</span>
    <span class="token property">id</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">animNormalize</span>
    <span class="token property">running</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token operator">!</span>genieEffect<span class="token punctuation">.</span>minimized</span>
    <span class="token class-name">NumberAnimation</span> <span class="token punctuation">{</span> <span class="token property">to</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">0</span></span><span class="token punctuation">;</span> <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">700</span></span><span class="token punctuation">;</span> <span class="token property">easing.type</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">Easing<span class="token punctuation">.</span>InOutSine </span><span class="token punctuation">}</span>
    <span class="token class-name">PauseAnimation</span> <span class="token punctuation">{</span> <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">1300</span> </span><span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div><p>The animation is triggered by the toggling of the <em>minimized</em> property. Now that we have set up all our surroundings we finally can look at our vertex shader.</p> <div class="language-vert extra-class"><pre class="language-text"><code>#version 440

layout(location=0) in vec4 qt_Vertex;
layout(location=1) in vec2 qt_MultiTexCoord0;

layout(location=0) out vec2 qt_TexCoord0;

layout(std140, binding=0) uniform buf {
    mat4 qt_Matrix;
    float qt_Opacity;

    float minimize;
    float width;
    float height;
} ubuf;

out gl_PerVertex { 
    vec4 gl_Position;
};

void main() {
    qt_TexCoord0 = qt_MultiTexCoord0;
    vec4 pos = qt_Vertex;
    pos.y = mix(qt_Vertex.y, ubuf.height, ubuf.minimize);
    pos.x = mix(qt_Vertex.x, ubuf.width, ubuf.minimize);
    gl_Position = ubuf.qt_Matrix * pos;
}</code></pre></div><p>The vertex shader is called for each vertex so four times, in our case. The default qt defined parameters are provided, like <em>qt_Matrix</em>, <em>qt_Vertex</em>, <em>qt_MultiTexCoord0</em>, <em>qt_TexCoord0</em>. We have discussed the variable already earlier. Additional we link the <em>minimize</em>, <em>width</em> and <em>height</em> variables from our shader effect into our vertex shader code. In the main function, we store the current texture coordinate in our <em>qt_TexCoord0</em> to make it available to the fragment shader. Now we copy the current position and modify the x and y position of the vertex:</p> <div class="language-glsl extra-class"><pre class="language-glsl"><code><span class="token keyword">vec4</span> pos <span class="token operator">=</span> qt_Vertex<span class="token punctuation">;</span>
pos<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token function">mix</span><span class="token punctuation">(</span>qt_Vertex<span class="token punctuation">.</span>y<span class="token punctuation">,</span> ubuf<span class="token punctuation">.</span>height<span class="token punctuation">,</span> ubuf<span class="token punctuation">.</span>minimize<span class="token punctuation">)</span><span class="token punctuation">;</span>
pos<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token function">mix</span><span class="token punctuation">(</span>qt_Vertex<span class="token punctuation">.</span>x<span class="token punctuation">,</span> ubuf<span class="token punctuation">.</span>width<span class="token punctuation">,</span> ubuf<span class="token punctuation">.</span>minimize<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The <code>mix(…)</code> function provides a linear interpolation between the first 2 parameters on the point (0.0-1.0) provided by the 3rd parameter. So in our case, we interpolate for y between the current y position and the height based on the current minimized value, similar for x. Bear in mind the minimized value is animated by our sequential animation and travels from 0.0 to 1.0 (or vice versa).</p> <p><img src="/qt6book/assets/img/genieminimize.ed2f7e18.png" alt="image"></p> <p>The resulting effect is not really the genie effect but is already a great step towards it.</p> <h2 id="primitive-bending"><a href="#primitive-bending" class="header-anchor">#</a> Primitive Bending</h2> <p>So minimized the x and y components of our vertexes. Now we would like to slightly modify the x manipulation and make it depending on the current y value. The needed changes are pretty small. The y-position is calculated as before. The interpolation of the x-position depends now on the vertexes y-position:</p> <div class="language-glsl extra-class"><pre class="language-glsl"><code><span class="token keyword">float</span> t <span class="token operator">=</span> pos<span class="token punctuation">.</span>y <span class="token operator">/</span> ubuf<span class="token punctuation">.</span>height<span class="token punctuation">;</span>
pos<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token function">mix</span><span class="token punctuation">(</span>qt_Vertex<span class="token punctuation">.</span>x<span class="token punctuation">,</span> ubuf<span class="token punctuation">.</span>width<span class="token punctuation">,</span> t <span class="token operator">*</span> minimize<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This results in an x-position tending towards the width when the y-position is larger. In other words, the upper 2 vertexes are not affected at all as they have a y-position of 0 and the lower two vertexes x-positions both bend towards the width, so they bend towards the same x-position.</p> <p><img src="/qt6book/assets/img/geniebending.d2d8582d.png" alt="image"></p> <h2 id="better-bending"><a href="#better-bending" class="header-anchor">#</a> Better Bending</h2> <p>As the bending is not really satisfying currently we will add several parts to improve the situation.
First, we enhance our animation to support an own bending property. This is necessary as the bending should happen immediately and the y-minimization should be delayed shortly. Both animations have in the sum the same duration (300+700+1000 and 700+1300).</p> <p>We first add and animate <code>bend</code> from QML.</p> <div class="language-qml extra-class"><pre class="language-qml"><code><span class="token property"><span class="token keyword">property</span> <span class="token property">real</span> <span class="token property">bend</span></span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">0.0</span></span>
<span class="token property"><span class="token keyword">property</span> <span class="token property">bool</span> <span class="token property">minimized</span></span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token boolean">false</span></span>


<span class="token comment">// change to parallel animation</span>
<span class="token class-name">ParallelAnimation</span> <span class="token punctuation">{</span>
    <span class="token property">id</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">animMinimize</span>
    <span class="token property">running</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">genieEffect<span class="token punctuation">.</span>minimized</span>
    <span class="token class-name">SequentialAnimation</span> <span class="token punctuation">{</span>
        <span class="token class-name">PauseAnimation</span> <span class="token punctuation">{</span> <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">300</span> </span><span class="token punctuation">}</span>
        <span class="token class-name">NumberAnimation</span> <span class="token punctuation">{</span>
            <span class="token property">target</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">genieEffect</span><span class="token punctuation">;</span> <span class="token property">property</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token string">'minimize'</span></span><span class="token punctuation">;</span>
            <span class="token property">to</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">1</span></span><span class="token punctuation">;</span> <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">700</span></span><span class="token punctuation">;</span>
            <span class="token property">easing.type</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">Easing<span class="token punctuation">.</span>InOutSine</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">PauseAnimation</span> <span class="token punctuation">{</span> <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">1000</span> </span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// adding bend animation</span>
    <span class="token class-name">SequentialAnimation</span> <span class="token punctuation">{</span>
        <span class="token class-name">NumberAnimation</span> <span class="token punctuation">{</span>
            <span class="token property">target</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">genieEffect</span><span class="token punctuation">;</span> <span class="token property">property</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token string">'bend'</span></span>
            <span class="token property">to</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">1</span></span><span class="token punctuation">;</span> <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">700</span></span><span class="token punctuation">;</span>
            <span class="token property">easing.type</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">Easing<span class="token punctuation">.</span>InOutSine </span><span class="token punctuation">}</span>
        <span class="token class-name">PauseAnimation</span> <span class="token punctuation">{</span> <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">1300</span> </span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div><p>We then add <code>bend</code> to the uniform buffer, <code>ubuf</code> and use it in the shader to achieve a smoother bending.</p> <div class="language-vert extra-class"><pre class="language-text"><code>#version 440

layout(location=0) in vec4 qt_Vertex;
layout(location=1) in vec2 qt_MultiTexCoord0;

layout(location=0) out vec2 qt_TexCoord0;

layout(std140, binding=0) uniform buf {
    mat4 qt_Matrix;
    float qt_Opacity;

    float minimize;
    float width;
    float height;
    float bend;
} ubuf;

out gl_PerVertex { 
    vec4 gl_Position;
};

void main() {
    qt_TexCoord0 = qt_MultiTexCoord0;
    vec4 pos = qt_Vertex;
    pos.y = mix(qt_Vertex.y, ubuf.height, ubuf.minimize);
    float t = pos.y / ubuf.height;
    t = (3.0 - 2.0 * t) * t * t;
    pos.x = mix(qt_Vertex.x, ubuf.width, t * ubuf.bend);
    gl_Position = ubuf.qt_Matrix * pos;
}</code></pre></div><p>The curve starts smooth at the 0.0 value, grows then and stops smoothly towards the 1.0 value. Here is a plot of the function in the specified range. For us, only the range from 0..1 is from interest.</p> <p><img src="/qt6book/assets/img/curve.dc6c88c8.png" alt="image"></p> <p>We also need to increase the number of vertex points. The vertex points used can be increased by using a mesh.</p> <div class="language-qml extra-class"><pre class="language-qml"><code><span class="token property">mesh</span><span class="token punctuation">:</span> <span class="token class-name">GridMesh</span> <span class="token punctuation">{</span> <span class="token property">resolution</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">Qt<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> </span><span class="token punctuation">}</span>
</code></pre></div><p>The shader effect now has an equality distributed grid of 16x16 vertexes instead of the 2x2 vertexes used before. This makes the interpolation between the vertexes look much smoother.</p> <p><img src="/qt6book/assets/img/geniesmoothbending.a6b12c50.png" alt="image"></p> <p>You can see also the influence of the curve being used, as the bending smoothes at the end nicely. This is where the bending has the strongest effect.</p> <h2 id="choosing-sides"><a href="#choosing-sides" class="header-anchor">#</a> Choosing Sides</h2> <p>As a final enhancement, we want to be able to switch sides. The side is towards which point the genie effect vanishes. Until now it vanishes always towards the width. By adding a <code>side</code> property we are able to modify the point between 0 and width.</p> <div class="language-qml extra-class"><pre class="language-qml"><code><span class="token class-name">ShaderEffect</span> <span class="token punctuation">{</span>
    ...
    <span class="token property"><span class="token keyword">property</span> <span class="token property">real</span> <span class="token property">side</span></span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">0.5</span></span>
    ...
<span class="token punctuation">}</span>
</code></pre></div><div class="language-vert extra-class"><pre class="language-text"><code>#version 440

layout(location=0) in vec4 qt_Vertex;
layout(location=1) in vec2 qt_MultiTexCoord0;

layout(location=0) out vec2 qt_TexCoord0;

layout(std140, binding=0) uniform buf {
    mat4 qt_Matrix;
    float qt_Opacity;

    float minimize;
    float width;
    float height;
    float bend;
    float side;
} ubuf;

out gl_PerVertex { 
    vec4 gl_Position;
};

void main() {
    qt_TexCoord0 = qt_MultiTexCoord0;
    vec4 pos = qt_Vertex;
    pos.y = mix(qt_Vertex.y, ubuf.height, ubuf.minimize);
    float t = pos.y / ubuf.height;
    t = (3.0 - 2.0 * t) * t * t;
    pos.x = mix(qt_Vertex.x, ubuf.side * ubuf.width, t * ubuf.bend);
    gl_Position = ubuf.qt_Matrix * pos;
}</code></pre></div><p><img src="/qt6book/assets/img/geniehalfside.256f81db.png" alt="image"></p> <h2 id="packaging"><a href="#packaging" class="header-anchor">#</a> Packaging</h2> <p>The last thing to-do is packaging our effect nicely. For this, we extract our genie effect code into an own component called <code>GenieEffect</code>. It has the shader effect as the root element. We removed the mouse area as this should not be inside the component as the triggering of the effect can be toggled by the <code>minimized</code> property.</p> <div class="language-qml extra-class"><pre class="language-qml"><code><span class="token comment">// GenieEffect.qml</span>
<span class="token keyword">import</span> QtQuick

<span class="token class-name">ShaderEffect</span> <span class="token punctuation">{</span>
    <span class="token property">id</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">genieEffect</span>
    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">160</span></span><span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">width</span>
    <span class="token property">anchors.centerIn</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">parent</span>
    property variant source
    <span class="token property">mesh</span><span class="token punctuation">:</span> <span class="token class-name">GridMesh</span> <span class="token punctuation">{</span> <span class="token property">resolution</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">Qt<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> </span><span class="token punctuation">}</span>
    <span class="token property"><span class="token keyword">property</span> <span class="token property">real</span> <span class="token property">minimize</span></span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">0.0</span></span>
    <span class="token property"><span class="token keyword">property</span> <span class="token property">real</span> <span class="token property">bend</span></span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">0.0</span></span>
    <span class="token property"><span class="token keyword">property</span> <span class="token property">bool</span> <span class="token property">minimized</span></span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token boolean">false</span></span>
    <span class="token property"><span class="token keyword">property</span> <span class="token property">real</span> <span class="token property">side</span></span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">1.0</span></span>


    <span class="token class-name">ParallelAnimation</span> <span class="token punctuation">{</span>
        <span class="token property">id</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">animMinimize</span>
        <span class="token property">running</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">genieEffect<span class="token punctuation">.</span>minimized</span>
        <span class="token class-name">SequentialAnimation</span> <span class="token punctuation">{</span>
            <span class="token class-name">PauseAnimation</span> <span class="token punctuation">{</span> <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">300</span> </span><span class="token punctuation">}</span>
            <span class="token class-name">NumberAnimation</span> <span class="token punctuation">{</span>
                <span class="token property">target</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">genieEffect</span><span class="token punctuation">;</span> <span class="token property">property</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token string">'minimize'</span></span><span class="token punctuation">;</span>
                <span class="token property">to</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">1</span></span><span class="token punctuation">;</span> <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">700</span></span><span class="token punctuation">;</span>
                <span class="token property">easing.type</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">Easing<span class="token punctuation">.</span>InOutSine</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">PauseAnimation</span> <span class="token punctuation">{</span> <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">1000</span> </span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">SequentialAnimation</span> <span class="token punctuation">{</span>
            <span class="token class-name">NumberAnimation</span> <span class="token punctuation">{</span>
                <span class="token property">target</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">genieEffect</span><span class="token punctuation">;</span> <span class="token property">property</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token string">'bend'</span></span>
                <span class="token property">to</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">1</span></span><span class="token punctuation">;</span> <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">700</span></span><span class="token punctuation">;</span>
                <span class="token property">easing.type</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">Easing<span class="token punctuation">.</span>InOutSine </span><span class="token punctuation">}</span>
            <span class="token class-name">PauseAnimation</span> <span class="token punctuation">{</span> <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">1300</span> </span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">ParallelAnimation</span> <span class="token punctuation">{</span>
        <span class="token property">id</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">animNormalize</span>
        <span class="token property">running</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token operator">!</span>genieEffect<span class="token punctuation">.</span>minimized</span>
        <span class="token class-name">SequentialAnimation</span> <span class="token punctuation">{</span>
            <span class="token class-name">NumberAnimation</span> <span class="token punctuation">{</span>
                <span class="token property">target</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">genieEffect</span><span class="token punctuation">;</span> <span class="token property">property</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token string">'minimize'</span></span><span class="token punctuation">;</span>
                <span class="token property">to</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">0</span></span><span class="token punctuation">;</span> <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">700</span></span><span class="token punctuation">;</span>
                <span class="token property">easing.type</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">Easing<span class="token punctuation">.</span>InOutSine</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">PauseAnimation</span> <span class="token punctuation">{</span> <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">1300</span> </span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">SequentialAnimation</span> <span class="token punctuation">{</span>
            <span class="token class-name">PauseAnimation</span> <span class="token punctuation">{</span> <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">300</span> </span><span class="token punctuation">}</span>
            <span class="token class-name">NumberAnimation</span> <span class="token punctuation">{</span>
                <span class="token property">target</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">genieEffect</span><span class="token punctuation">;</span> <span class="token property">property</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token string">'bend'</span></span>
                <span class="token property">to</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">0</span></span><span class="token punctuation">;</span> <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">700</span></span><span class="token punctuation">;</span>
                <span class="token property">easing.type</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">Easing<span class="token punctuation">.</span>InOutSine </span><span class="token punctuation">}</span>
            <span class="token class-name">PauseAnimation</span> <span class="token punctuation">{</span> <span class="token property">duration</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">1000</span> </span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token property">vertexShader</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token string">&quot;genieeffect.vert.qsb&quot;</span></span>
<span class="token punctuation">}</span></code></pre></div><div class="language-vert extra-class"><pre class="language-text"><code>// genieeffect.vert
#version 440

layout(location=0) in vec4 qt_Vertex;
layout(location=1) in vec2 qt_MultiTexCoord0;

layout(location=0) out vec2 qt_TexCoord0;

layout(std140, binding=0) uniform buf {
    mat4 qt_Matrix;
    float qt_Opacity;

    float minimize;
    float width;
    float height;
    float bend;
    float side;
} ubuf;

out gl_PerVertex { 
    vec4 gl_Position;
};

void main() {
    qt_TexCoord0 = qt_MultiTexCoord0;
    vec4 pos = qt_Vertex;
    pos.y = mix(qt_Vertex.y, ubuf.height, ubuf.minimize);
    float t = pos.y / ubuf.height;
    t = (3.0 - 2.0 * t) * t * t;
    pos.x = mix(qt_Vertex.x, ubuf.side * ubuf.width, t * ubuf.bend);
    gl_Position = ubuf.qt_Matrix * pos;
}</code></pre></div><p>You can use now the effect simply like this:</p> <div class="language-qml extra-class"><pre class="language-qml"><code><span class="token keyword">import</span> QtQuick

<span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">480</span></span><span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token number">240</span></span>
    <span class="token property">color</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token string">'#1e1e1e'</span></span>

    <span class="token class-name">GenieEffect</span> <span class="token punctuation">{</span>
        <span class="token property">source</span><span class="token punctuation">:</span> <span class="token class-name">Image</span> <span class="token punctuation">{</span> <span class="token property">source</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript"><span class="token string">'../../assets/lighthouse.jpg'</span> </span><span class="token punctuation">}</span>
        <span class="token class-name">MouseArea</span> <span class="token punctuation">{</span>
            <span class="token property">anchors.fill</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">parent</span>
            <span class="token property">onClicked</span><span class="token punctuation">:</span> <span class="token javascript-expression language-javascript">parent<span class="token punctuation">.</span>minimized <span class="token operator">=</span> <span class="token operator">!</span>parent<span class="token punctuation">.</span>minimized</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div><p>We have simplified the code by removing our background rectangle and we assigned the image directly to the effect, instead of loading it inside a standalone image element.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/dogifyc/qt6book/edit/main/docs/ch10-effects/vertex-shader.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/qt6book/ch10-effects/wave-effect.html" class="prev">
        Wave Effect
      </a></span> <span class="next"><a href="/qt6book/ch10-effects/curtain-effect.html">
        Curtain Effect
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/qt6book/assets/js/app.49f675f8.js" defer></script><script src="/qt6book/assets/js/2.ea318f3c.js" defer></script><script src="/qt6book/assets/js/6.381344fb.js" defer></script>
  </body>
</html>
